<!-- <xml version="1.0" encoding="utf-8"> -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for Cygwin (vers 1st September 2004), see www.w3.org" />

  <title>R quick reference card</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Org-mode" />
  <meta name="author" content="Fabrice Niessen" />
  <link rel="stylesheet" type="text/css" href=
  "http://www.pirilampo.org/styles/bigblow/css/htmlize.css" />
  <link rel="stylesheet" type="text/css" href=
  "http://www.pirilampo.org/styles/bigblow/css/bigblow.css" />
  <link rel="stylesheet" type="text/css" href=
  "http://www.pirilampo.org/styles/bigblow/css/hideshow.css" />
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/jquery-1.11.0.min.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/jquery.zclip.min.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/bigblow.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/hideshow.js">
</script>
</head>

<body>
  <div id="content">
    <h1 class="title">R quick reference card</h1>

    <div id="table-of-contents">
      <h2>Table of Contents</h2>

      <div id="text-table-of-contents">
        <ul>
          <li><a href="#sec-1">1. R reference card</a></li>

          <li><a href="#sec-2">2. Documentation</a></li>

          <li><a href="#sec-3">3. Coding style</a></li>

          <li>
            <a href="#sec-4">4. Emacs Speaks Statistics (ESS) key bindings</a>

            <ul>
              <li><a href="#sec-4-1">4.1. References</a></li>

              <li>
                <a href="#sec-4-2">4.2. Interacting with the ESS process</a>

                <ul>
                  <li><a href="#sec-4-2-1">Command History</a></li>

                  <li><a href="#sec-4-2-2">Hot keys for common
                  commands</a></li>

                  <li><a href="#sec-4-2-3">Other commands provided by
                  inferior-ESS</a></li>
                </ul>
              </li>

              <li><a href="#sec-4-3">4.3. Sending code to the iESS
              process</a></li>

              <li><a href="#sec-4-4">4.4. Manipulating saved transcript
              files</a></li>

              <li>
                <a href="#sec-4-5">4.5. Editing objects and functions</a>

                <ul>
                  <li><a href="#sec-4-5-1">Creating or modifying
                  objects</a></li>

                  <li><a href="#sec-4-5-2">Loading source files into the ESS
                  process</a></li>

                  <li>
                    <a href="#sec-4-5-3">Commands for motion, completion and
                    more</a>

                    <ul>
                      <li><a href="#sec-4-5-3-1">Tags Tables</a></li>
                    </ul>
                  </li>
                </ul>
              </li>

              <li><a href="#sec-4-6">4.6. Reading help files</a></li>

              <li>
                <a href="#sec-4-7">4.7. Completion</a>

                <ul>
                  <li><a href="#sec-4-7-1">Integration with auto-complete
                  package</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-4-8">4.8. Developing with ESS</a>

                <ul>
                  <li>
                    <a href="#sec-4-8-1">ESS tracebug</a>

                    <ul>
                      <li><a href="#sec-4-8-1-1">Breakpoints</a></li>

                      <li><a href="#sec-4-8-1-2">Debugging</a></li>

                      <li><a href="#sec-4-8-1-3">Interactive debugging</a></li>

                      <li><a href="#sec-4-8-1-4">Navigation to errors</a></li>

                      <li><a href="#sec-4-8-1-5">Tracebug visual
                      debugger</a></li>
                    </ul>
                  </li>

                  <li><a href="#sec-4-8-2">ESS developer</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-4-9">4.9. Other ESS features and tools</a>

                <ul>
                  <li><a href="#sec-4-9-1">ElDoc</a></li>
                </ul>
              </li>

              <li><a href="#sec-4-10">4.10. Other Emacs features and
              tools</a></li>
            </ul>
          </li>

          <li><a href="#sec-5">5. 0. Overview of R</a></li>

          <li><a href="#sec-6">6. 1. Getting started and getting help</a></li>

          <li>
            <a href="#sec-7">7. 2. Some basics</a>

            <ul>
              <li><a href="#sec-7-1">7.1. Print something</a></li>

              <li><a href="#sec-7-2">7.2. Setting variables</a></li>

              <li><a href="#sec-7-3">7.3. Listing variables</a></li>

              <li><a href="#sec-7-4">7.4. Deleting variables</a></li>

              <li><a href="#sec-7-5">7.5. Computing basic statistics</a></li>

              <li><a href="#sec-7-6">7.6. Creating sequences</a></li>

              <li><a href="#sec-7-7">7.7. Operators</a></li>

              <li><a href="#sec-7-8">7.8. Defining a function</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-8">8. 3. Navigating the software</a>

            <ul>
              <li><a href="#sec-8-1">8.1. Running a batch script</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-9">9. 5. Data structures</a>

            <ul>
              <li><a href="#sec-9-1">9.1. Basic (“atomic”) vector
              types</a></li>

              <li><a href="#sec-9-2">9.2. Vectors</a></li>

              <li><a href="#sec-9-3">9.3. Matrices</a></li>

              <li><a href="#sec-9-4">9.4. Arrays</a></li>

              <li><a href="#sec-9-5">9.5. Lists</a></li>

              <li><a href="#sec-9-6">9.6. Factors</a></li>

              <li><a href="#sec-9-7">9.7. Data frames</a></li>

              <li><a href="#sec-9-8">9.8. Vectorized operations (recycling
              rule)</a></li>

              <li><a href="#sec-9-9">9.9. Selecting list elements or data frame
              columns by position (subsetting)</a></li>

              <li><a href="#sec-9-10">9.10. Selecting list elements or data
              frame columns by name (subsetting)</a></li>

              <li><a href="#sec-9-11">9.11. Selecting data frame columns by
              position (subsetting)</a></li>

              <li><a href="#sec-9-12">9.12. Flatten a list into a
              vector</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-10">10. Control structures</a>

            <ul>
              <li><a href="#sec-10-1">10.1. Conditional statements</a></li>

              <li><a href="#sec-10-2">10.2. Loops</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-11">11. Writing functions</a>

            <ul>
              <li><a href="#sec-11-1">11.1. Arguments</a></li>

              <li><a href="#sec-11-2">11.2. Scoping rules for R</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-12">12. 4. Input and output</a>

            <ul>
              <li><a href="#sec-12-1">12.1. Getting the current working
              directory</a></li>

              <li><a href="#sec-12-2">12.2. Creating, opening and closing
              connections</a></li>

              <li><a href="#sec-12-3">12.3. Reading tabular data files</a></li>

              <li><a href="#sec-12-4">12.4. Writing tabular data files</a></li>

              <li><a href="#sec-12-5">12.5. Reading from CSV files</a></li>

              <li><a href="#sec-12-6">12.6. Reading from Excel files</a></li>

              <li><a href="#sec-12-7">12.7. Reading files from the
              Internet</a></li>

              <li><a href="#sec-12-8">12.8. Reading files with a complex
              structure</a></li>

              <li><a href="#sec-12-9">12.9. Reading from SQL Server
              databases</a></li>

              <li><a href="#sec-12-10">12.10. Saving and transporting
              objects</a></li>

              <li><a href="#sec-12-11">12.11. Further resources</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-13">13. 12. Useful tricks</a>

            <ul>
              <li><a href="#sec-13-1">13.1. Peeking at your data</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-14">14. 9. General statistics</a>

            <ul>
              <li><a href="#sec-14-1">14.1. Summarizing your data</a></li>

              <li><a href="#sec-14-2">14.2. Tabulating factors</a></li>

              <li><a href="#sec-14-3">14.3. Testing categorical variables for
              independence</a></li>

              <li><a href="#sec-14-4">14.4. Calculating quantiles (and
              quartiles) of a dataset</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-15">15. 6. Data transformations</a>

            <ul>
              <li><a href="#sec-15-1">15.1. Fixing variable names</a></li>

              <li><a href="#sec-15-2">15.2. Creating new variables</a></li>

              <li><a href="#sec-15-3">15.3. Change the class of many columns
              from factor to character (or numeric)</a></li>

              <li><a href="#sec-15-4">15.4. Removing list elements using a
              condition</a></li>

              <li><a href="#sec-15-5">15.5. Selecting rows and columns more
              easily</a></li>

              <li><a href="#sec-15-6">15.6. Removing NA from a list</a></li>

              <li><a href="#sec-15-7">15.7. Removing rows that contain NAs from
              a data frame</a></li>

              <li><a href="#sec-15-8">15.8. Removing columns that contain NAs
              from a data frame</a></li>

              <li><a href="#sec-15-9">15.9. Removing columns by name</a></li>

              <li><a href="#sec-15-10">15.10. Merging data frames by common
              column</a></li>

              <li><a href="#sec-15-11">15.11. Convert a list of data frames
              into one data frame</a></li>

              <li><a href="#sec-15-12">15.12. Converting</a></li>

              <li>
                <a href="#sec-15-13">15.13. Applying a function to each list
                element</a>

                <ul>
                  <li><a href="#sec-15-13-1"><code>lapply</code></a></li>

                  <li><a href="#sec-15-13-2"><code>sapply</code></a></li>
                </ul>
              </li>

              <li><a href="#sec-15-14">15.14. Splitting a vector into
              groups</a></li>

              <li><a href="#sec-15-15">15.15. Applying a function to every
              row/column</a></li>

              <li><a href="#sec-15-16">15.16. Applying a function to groups of
              data</a></li>

              <li><a href="#sec-15-17">15.17. Applying a function to parallel
              vectors or lists</a></li>

              <li><a href="#sec-15-18">15.18. Checking on and removing
              inconsistent values</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-16">16. 7. Strings and dates</a>

            <ul>
              <li><a href="#sec-16-1">16.1. Getting the length of a
              string</a></li>

              <li><a href="#sec-16-2">16.2. Concatenating strings</a></li>

              <li>
                <a href="#sec-16-3">16.3. Regular expressions</a>

                <ul>
                  <li><a href="#sec-16-3-1">Metacharacters</a></li>

                  <li><a href="#sec-16-3-2">Regular expressions in R</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a href="#sec-17">17. 8. Probability</a>

            <ul>
              <li><a href="#sec-17-1">17.1. Names of distributions</a></li>

              <li><a href="#sec-17-2">17.2. Generate reproducible random
              numbers</a></li>

              <li><a href="#sec-17-3">17.3. Generate a random sample</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-18">18. 10. Graphics</a>

            <ul>
              <li>
                <a href="#sec-18-1">18.1. Base graphics</a>

                <ul>
                  <li>
                    <a href="#sec-18-1-1">Make a plot</a>

                    <ul>
                      <li><a href="#sec-18-1-1-1">Create a scatter
                      plot</a></li>

                      <li><a href="#sec-18-1-1-2"><span class=
                      "todo nilTODO">TODO</span> <code>barplot</code></a></li>

                      <li><a href="#sec-18-1-1-3"><code>hist</code></a></li>

                      <li><a href="#sec-18-1-1-4"><code>boxplot</code></a></li>

                      <li><a href="#sec-18-1-1-5">violinplot</a></li>
                    </ul>
                  </li>

                  <li><a href="#sec-18-1-2">Add to an existing plot</a></li>

                  <li><a href="#sec-18-1-3">Changing graphical
                  parameters</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-18-2">18.2. Lattice graphics</a>

                <ul>
                  <li><a href="#sec-18-2-1">Splom</a></li>

                  <li><a href="#sec-18-2-2">Histogram</a></li>
                </ul>
              </li>

              <li><a href="#sec-18-3">18.3. ggplot2</a></li>

              <li>
                <a href="#sec-18-4">18.4. Other graphics</a>

                <ul>
                  <li><a href="#sec-18-4-1">Pareto diagrams</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a href="#sec-19">19. 11. Linear regression and ANOVA</a>

            <ul>
              <li><a href="#sec-19-1">19.1. Linear model</a></li>

              <li><a href="#sec-19-2">19.2. Regression tree models</a></li>

              <li><a href="#sec-19-3">19.3. Classification tree models</a></li>
            </ul>
          </li>

          <li><a href="#sec-20">20. Debugging</a></li>

          <li><a href="#sec-21">21. Assert</a></li>
        </ul>
      </div>
    </div>

    <div id="outline-container-sec-1" class="outline-2">
      <h2 id="sec-1"><span class="section-number-2">1</span> R reference
      card</h2>

      <div class="outline-text-2" id="text-1">
        <p>Welcome to R reference card. It contains the reference documentation
        that describes how to perform <b>data analysis</b> using R.</p>
      </div>
    </div>

    <div id="outline-container-sec-2" class="outline-2">
      <h2 id="sec-2"><span class="section-number-2">2</span> Documentation</h2>

      <div class="outline-text-2" id="text-2">
        <ul class="org-ul">
          <li><a href="http://www.rdocumentation.org/">Search the documentation
          of R packages and R functions</a></li>

          <li><a href="http://www.statmethods.net/">Quick-R</a></li>
        </ul>
      </div>
    </div>

    <div id="outline-container-sec-3" class="outline-2">
      <h2 id="sec-3"><span class="section-number-2">3</span> Coding style</h2>

      <div class="outline-text-2" id="text-3">
        <ul class="org-ul">
          <li><a href=
          "http://cran.r-project.org/doc/manuals/R-ints.html#R-coding-standards">
          R Internals manual, section 8. “R Coding Standards”</a></li>

          <li><a href="http://adv-r.had.co.nz/Style.html">R coding style
          guide</a></li>

          <li><a href=
          "https://docs.google.com/document/d/1esDVxyWvH8AsX-VJa-8oqWaHLs4stGlIbk8kLc5VlII/edit?pli=1">
          R Coding Conventions</a></li>

          <li>
            <p><a href=
            "http://google-styleguide.googlecode.com/svn/trunk/Rguide.xml">Google
            R Style Guide</a></p>

            <p><code>variable.name</code> (preferred, <code>variableName</code>
            accepted)<br />
            <code>FunctionName</code><br />
            <code>kConstantName</code></p>

            <p>Place spaces around all binary operators (=, +, -, &lt;-,
            etc.).<br />
            Exception: Spaces around =’s are optional when passing parameters
            in a function call.</p>

            <p>Do not place a space before a comma, but always place one after
            a comma.</p>
          </li>
        </ul>
      </div>
    </div>

    <div id="outline-container-sec-4" class="outline-2">
      <h2 id="sec-4"><span class="section-number-2">4</span> Emacs Speaks
      Statistics (ESS) key bindings</h2>

      <div class="outline-text-2" id="text-4">
        <p>Most of the shortcuts are actually mnemonic and hierarchical:</p>

        <ul class="org-ul">
          <li><code>C-c C-d</code> for <code>doc-map</code>,</li>

          <li><code>C-c C-e</code> for <code>extra-map</code>,</li>

          <li><code>C-c C-t</code> for <code>dev-map</code> which includes
          mostly [t]racebug.</li>
        </ul>
      </div>

      <div id="outline-container-sec-4-1" class="outline-3">
        <h3 id="sec-4-1"><span class="section-number-3">4.1</span>
        References</h3>

        <div class="outline-text-3" id="text-4-1">
          <p>See</p>

          <ul class="org-ul">
            <li><a href=
            "http://ess.r-project.org/refcard.pdf">http://ess.r-project.org/refcard.pdf</a></li>

            <li><a href=
            "http://www.damtp.cam.ac.uk/user/sje30/ess11/ess-slides.pdf">http://www.damtp.cam.ac.uk/user/sje30/ess11/ess-slides.pdf</a></li>
          </ul>
        </div>
      </div>

      <div id="outline-container-sec-4-2" class="outline-3">
        <h3 id="sec-4-2"><span class="section-number-3">4.2</span> Interacting
        with the ESS process</h3>

        <div class="outline-text-3" id="text-4-2"></div>

        <div id="outline-container-sec-4-2-1" class="outline-4">
          <h4 id="sec-4-2-1">Command History</h4>

          <div class="outline-text-4" id="text-4-2-1">
            <dl class="org-dl">
              <dt><code>M-r</code></dt>

              <dd>
                <p>Search for a regular expression backward in the command
                history (using Isearch).</p>

                <p>This is worth a wealth…</p>
              </dd>
            </dl>
          </div>
        </div>

        <div id="outline-container-sec-4-2-2" class="outline-4">
          <h4 id="sec-4-2-2">Hot keys for common commands</h4>

          <div class="outline-text-4" id="text-4-2-2">
            <p>ESS handling of <b>multiple processes</b> is pretty unique.</p>

            <dl class="org-dl">
              <dt><code>C-c C-s</code></dt>

              <dd>ess-switch-process</dd>

              <dt><code>C-c C-q</code></dt>

              <dd>
                <p>Issue a <code>q()</code> command to the inferior process,
                and kill all the temporary buffers.</p>

                <p>Press <code>C-c C-q</code> + <code>M-x R</code> to quickly
                restart the R console (without restarting the editor).</p>
              </dd>
            </dl>
          </div>
        </div>

        <div id="outline-container-sec-4-2-3" class="outline-4">
          <h4 id="sec-4-2-3">Other commands provided by inferior-ESS</h4>

          <div class="outline-text-4" id="text-4-2-3">
            <dl class="org-dl">
              <dt><code>C-c C-z</code></dt>

              <dd><b>Switch to</b> the (most recent) <b>script buffer</b>.</dd>
            </dl>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-4-3" class="outline-3">
        <h3 id="sec-4-3"><span class="section-number-3">4.3</span> Sending code
        to the iESS process</h3>

        <div class="outline-text-3" id="text-4-3">
          <p>Primary process interaction commands:</p>

          <dl class="org-dl">
            <dt><code>C-M-x</code></dt>

            <dd><b>Send</b> the current <b>region or function or paragraph</b>
            to the ESS process.</dd>

            <dt><code>C-c C-c</code></dt>

            <dd>
              <p><b>Send</b> the current <b>region or function or paragraph</b>
              (defined as continuous set of lines surrounded by a blank line at
              top and bottom) to the ESS process <b>and step</b> to the next
              line of code, skipping comments.</p>

              <p>If you group R statements into tasks, send the whole task to
              the R process without selecting anything.</p>
            </dd>

            <dt><code>C-RET</code></dt>

            <dd><b>Send</b> the current <b>region or line</b> to the ESS
            process <b>and step</b> to the next line of code.</dd>
          </dl>

          <p>Other evaluation commands:</p>

          <dl class="org-dl">
            <dt><code>C-c C-b</code></dt>

            <dd><b>Send</b> the current <b>buffer</b> to the ESS process.</dd>

            <dt><code>C-c C-r</code></dt>

            <dd><b>Send</b> the current <b>region</b> to the ESS process.</dd>

            <dt><code>C-c C-f</code></dt>

            <dd><b>Send</b> the current <b>function</b> to the ESS
            process.</dd>

            <dt><code>C-c C-p</code></dt>

            <dd><b>Send</b> the current <b>paragraph</b> to the ESS process
            <b>and step</b> to the next line of code.</dd>

            <dt><code>C-c C-n</code></dt>

            <dd><b>Send</b> the current <b>line</b> to the ESS process <b>and
            step</b> to the next line of code.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-4-4" class="outline-3">
        <h3 id="sec-4-4"><span class="section-number-3">4.4</span> Manipulating
        saved transcript files</h3>

        <div class="outline-text-3" id="text-4-4">
          <dl class="org-dl">
            <dt><code>C-u C-u C-y</code></dt>

            <dd>
              <p><b>Paste cleaned commands</b> (from a region copied with
              <code>M-w</code>) into a new R buffer or at the prompt: remove
              all prompts and command output, leaving only the commands.</p>

              <p>This is handy if you paste code from iESS, mail buffers or PDF
              documents.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-4-5" class="outline-3">
        <h3 id="sec-4-5"><span class="section-number-3">4.5</span> Editing
        objects and functions</h3>

        <div class="outline-text-3" id="text-4-5"></div>

        <div id="outline-container-sec-4-5-1" class="outline-4">
          <h4 id="sec-4-5-1">Creating or modifying objects</h4>

          <div class="outline-text-4" id="text-4-5-1">
            <p>In-session function editing.</p>

            <dl class="org-dl">
              <dt><code>C-c C-e C-d</code></dt>

              <dd><b>Edit</b> the code of an <b>object</b> (such as the
              function <code>lm</code>). Emacs opens a buffer called
              <code>&lt;user-login-name&gt;.&lt;object&gt;.R</code>.</dd>
            </dl>

            <p><code>C-c C-e d</code> and <code>C-c C-e C-d</code> can open
            file versions of R functions. <code>C-c C-e l</code> sends same
            back.</p>

            <p>Other nice tools ( probably not available in other editors):</p>

            <ul class="org-ul">
              <li><code>C-c C-e i</code> ess-install-library</li>

              <li><code>C-c C-e l</code> ess-load-library</li>

              <li><code>C-c C-e C-w</code> ess-execute-screen-options</li>
            </ul>
          </div>
        </div>

        <div id="outline-container-sec-4-5-2" class="outline-4">
          <h4 id="sec-4-5-2">Loading source files into the ESS process</h4>

          <div class="outline-text-4" id="text-4-5-2">
            <dl class="org-dl">
              <dt><code>C-c C-l</code></dt>

              <dd>
                <p><b>(Re-)Load a file</b> into the ESS process using
                <code>source()</code>.</p>

                <p>This usually works better than <code>C-c C-c</code> for
                reporting parsing errors <i>with a trace</i>.</p>
              </dd>
            </dl>
          </div>
        </div>

        <div id="outline-container-sec-4-5-3" class="outline-4">
          <h4 id="sec-4-5-3">Commands for motion, completion and more</h4>

          <div class="outline-text-4" id="text-4-5-3">
            <dl class="org-dl">
              <dt><code>C-c C-z</code></dt>

              <dd><b>Switch to</b> the associated <b>iESS process
              buffer</b>.</dd>
            </dl>
          </div>

          <div id="outline-container-sec-4-5-3-1" class="outline-5">
            <h5 id="sec-4-5-3-1">Tags Tables</h5>

            <div class="outline-text-5" id="text-4-5-3-1">
              <dl class="org-dl">
                <dt><code>C-c C-e C-t</code></dt>

                <dd>
                  <p>Build tag tables.</p>

                  <p>After building tags, use <code>M-.</code> to <b>jump
                  to</b> function and objects <b>definitions</b>.</p>
                </dd>
              </dl>

              <p>Probably the most used command of mine is imenu-anywhere.</p>

              <p>(global-set-key (kbd “C-.”) ‘imenu-anywhere)</p>

              <p>and you will be able to navigate to the definition of the
              symbol at point as long as the other file is open. This is like
              tag navigation but more convenient IMO. Both ido and helm
              interfaces are available.</p>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-4-6" class="outline-3">
        <h3 id="sec-4-6"><span class="section-number-3">4.6</span> Reading help
        files</h3>

        <div class="outline-text-3" id="text-4-6">
          <p>Help at your fingertips:</p>

          <dl class="org-dl">
            <dt><code>C-c C-d C-d</code> (or <code>C-c C-v</code>)</dt>

            <dd>
              <p>Display <b>R help</b> on an object (which has an help file)
              <b>in Emacs</b>, for example for the function call you’re
              currently writing.</p>

              <p>Same as typing <code>?&lt;object&gt;</code> in the iESS
              buffer.</p>

              <p>Then Press <code>l</code> to <b>run example</b> in R help
              page, <b>line by line</b>.</p>
            </dd>

            <dt><code>C-c C-d C-a</code></dt>

            <dd>Create an Apropos buffer with a linked list of apropos
            topics.</dd>

            <dt><code>C-c C-d i</code></dt>

            <dd>Display index of package.</dd>

            <dt><code>C-c C-d C-v</code></dt>

            <dd>Display vignettes.</dd>

            <dt><code>C-c C-d C-e</code></dt>

            <dd>
              <p><b>Describe object at point</b>.</p>

              <p>Repeat <code>C-e</code> to cycle through the list of
              commands:</p>

              <ul class="org-ul">
                <li><code>str()</code>,</li>

                <li><code>htsummary()</code>,</li>

                <li><code>summary()</code>.</li>
              </ul>
            </dd>

            <dt><code>C-c C-d o</code></dt>

            <dd>Create an Demos buffer with a linked list of available
            demos.</dd>

            <dt><code>C-c C-d C-w</code></dt>

            <dd>Search the web for documentation.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-4-7" class="outline-3">
        <h3 id="sec-4-7"><span class="section-number-3">4.7</span>
        Completion</h3>

        <div class="outline-text-3" id="text-4-7"></div>

        <div id="outline-container-sec-4-7-1" class="outline-4">
          <h4 id="sec-4-7-1">Integration with auto-complete package</h4>

          <div class="outline-text-4" id="text-4-7-1">
            <p>Auto-completion of objects and arguments: <a href=
            "http://www.emacswiki.org/emacs/ESSAuto-complete">http://www.emacswiki.org/emacs/ESSAuto-complete</a>.</p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-4-8" class="outline-3">
        <h3 id="sec-4-8"><span class="section-number-3">4.8</span> Developing
        with ESS</h3>

        <div class="outline-text-3" id="text-4-8"></div>

        <div id="outline-container-sec-4-8-1" class="outline-4">
          <h4 id="sec-4-8-1">ESS tracebug</h4>

          <div class="outline-text-4" id="text-4-8-1">
            <p>Tracebug highlighting of errors.</p>
          </div>

          <div id="outline-container-sec-4-8-1-1" class="outline-5">
            <h5 id="sec-4-8-1-1">Breakpoints</h5>

            <div class="outline-text-5" id="text-4-8-1-1">
              <dl class="org-dl">
                <dt><code>C-c C-t b</code></dt>

                <dd>Set breakpoint (repeat to cycle through the breakpoint
                types: <code>browser</code> and <code>recover</code>).</dd>

                <dt><code>C-c C-t B</code></dt>

                <dd>Set conditional breakpoint.</dd>

                <dt><code>C-c C-t l</code></dt>

                <dd>Set logger breakpoint.</dd>

                <dt><code>C-c C-t o</code></dt>

                <dd>Toggle the active/commented state of the breakpoint.</dd>

                <dt><code>C-c C-t k</code></dt>

                <dd>Kill breakpoint.</dd>

                <dt><code>C-c C-t K</code></dt>

                <dd>Kill all breakpoints.</dd>

                <dt><code>C-c C-t n</code></dt>

                <dd>Go to next breakpoint.</dd>

                <dt><code>C-c C-t p</code></dt>

                <dd>Go to previous breakpoint.</dd>
              </dl>

              <p>(<code>C-</code> prefixed equivalents are also defined)</p>
            </div>
          </div>

          <div id="outline-container-sec-4-8-1-2" class="outline-5">
            <h5 id="sec-4-8-1-2">Debugging</h5>

            <div class="outline-text-5" id="text-4-8-1-2">
              <dl class="org-dl">
                <dt><code>C-c C-t `</code> (also on <code>C-c `</code>)</dt>

                <dd>Show Traceback buffer (display source locations).</dd>

                <dt><code>C-c C-t ~</code> (also on <code>C-c ~</code>)</dt>

                <dd>Show call stack (display source locations).</dd>

                <dt><code>C-c C-t e</code></dt>

                <dd>
                  Toggle <b>on-error action</b> (repeat to cycle):

                  <ul class="org-ul">
                    <li><code>NONE</code> (“-” in the mode line)</li>

                    <li><code>RECOVER</code> (“r” in the mode line)</li>

                    <li><code>TRACEBACK</code> (“t” in the mode line)</li>
                  </ul>
                </dd>

                <dt><code>C-c C-t d</code></dt>

                <dd>Flag for debugging.</dd>

                <dt><code>C-c C-t u</code></dt>

                <dd>Unflag for debugging.</dd>

                <dt><code>C-c C-t w</code></dt>

                <dd>Use <code>ess-watch</code> while debugging to see variables
                change at each step, or even just at the prompt.</dd>
              </dl>

              <p>(<code>C-</code> prefixed equivalents are also defined)</p>
            </div>
          </div>

          <div id="outline-container-sec-4-8-1-3" class="outline-5">
            <h5 id="sec-4-8-1-3">Interactive debugging</h5>

            <div class="outline-text-5" id="text-4-8-1-3">
              <dl class="org-dl">
                <dt><code>M-C</code></dt>

                <dd>Continue</dd>

                <dt><code>C-M-S-c</code></dt>

                <dd>Continue multi</dd>

                <dt><code>M-N</code></dt>

                <dd>Next step</dd>

                <dt><code>C-M-S-n</code></dt>

                <dd>Next step multi</dd>

                <dt><code>M-U</code></dt>

                <dd>Up frame</dd>

                <dt><code>M-Q</code></dt>

                <dd>Quit debugging</dd>
              </dl>
            </div>
          </div>

          <div id="outline-container-sec-4-8-1-4" class="outline-5">
            <h5 id="sec-4-8-1-4">Navigation to errors</h5>

            <div class="outline-text-5" id="text-4-8-1-4">
              <div class="org-src-container">
                <pre class="src src-R">
<span class="org-constant">source</span>(file = <span class=
"org-string">"missing-file.R"</span>)
list(a=22, b=343)
^
protocol <span class="org-constant">&lt;-</span> <span class=
"org-type">NULL</span>
paste(<span class="org-string">"{**"</span>, })
<span class="org-keyword">stop</span>(<span class=
"org-string">"Test error"</span>)
</pre>
              </div>

              <p>The arrow in the left fringe of the iESS buffer is an
              indicator of the <b>beginning of the last evaluation</b>. It
              helps you to quickly pinpoint the first error (often the most
              relevant one) in the <code>*R*</code> buffer by searching for
              this arrow.</p>

              <p>Error navigation in the <code>*R*</code> buffer is limited to
              the region between this arrow and the end of the buffer.</p>

              <dl class="org-dl">
                <dt><code>M-g n</code> (<code>M-x next-error</code>)</dt>

                <dd>Next error.</dd>

                <dt><code>M-g p</code> (<code>M-x previous-error</code>)</dt>

                <dd>Previous error.</dd>
              </dl>
            </div>
          </div>

          <div id="outline-container-sec-4-8-1-5" class="outline-5">
            <h5 id="sec-4-8-1-5">Tracebug visual debugger</h5>
          </div>
        </div>

        <div id="outline-container-sec-4-8-2" class="outline-4">
          <h4 id="sec-4-8-2">ESS developer</h4>

          <div class="outline-text-4" id="text-4-8-2">
            <dl class="org-dl">
              <dt><code>C-c C-t C-a</code></dt>

              <dd>Add a package to your development list.</dd>

              <dt><code>C-c C-t C-t</code></dt>

              <dd>Toggle developer mode on and off.</dd>

              <dt><code>C-c C-t l</code></dt>

              <dd>ess-developer-load-package (this one is in ESS dev as
              yet).</dd>
            </dl>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-4-9" class="outline-3">
        <h3 id="sec-4-9"><span class="section-number-3">4.9</span> Other ESS
        features and tools</h3>

        <div class="outline-text-3" id="text-4-9"></div>

        <div id="outline-container-sec-4-9-1" class="outline-4">
          <h4 id="sec-4-9-1">ElDoc</h4>

          <div class="outline-text-4" id="text-4-9-1">
            <p><b>ElDoc</b> support: automatic display of function arguments in
            the <b>echo area</b>.</p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-4-10" class="outline-3">
        <h3 id="sec-4-10"><span class="section-number-3">4.10</span> Other
        Emacs features and tools</h3>

        <div class="outline-text-3" id="text-4-10">
          <p>I would add C-s and C-r to search in the help buffer and M-\ to
          indent</p>

          <p>Also the ability to mix in other, general purpose Emacs tools:</p>

          <p>paredit-mode to give me good shortcuts to navigate around and
          manipulate parentheses and braces,</p>

          <p>git-gutter-mode to keep tabs on lines I’ve changed in a file.</p>

          <p>M-/ to complete long words the second time I type them.</p>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-5" class="outline-2">
      <h2 id="sec-5"><span class="section-number-2">5</span> 0. Overview of
      R</h2>

      <div class="outline-text-2" id="text-5">
        <p>R system that you download from <a href=
        "http://cran.r-project.org/">CRAN</a>:</p>

        <ul class="org-ul">
          <li><code>base</code> package</li>

          <li>Familiar packages (<code>utils</code>, <code>datasets</code>,
          …)</li>

          <li>Recommended packages (<code>lattice</code>, …)</li>

          <li>4,000 other packages</li>
        </ul>

        <p><a href="http://cran.r-project.org/doc/contrib/Short-refcard.pdf">R
        Reference Card</a></p>

        <p>Some <a href="http://cran.r-project.org/manuals.html">R
        manuals</a>:</p>

        <ul class="org-ul">
          <li><a href="http://cran.r-project.org/doc/manuals/R-intro.html">An
          introduction to R</a></li>

          <li><a href=
          "http://cran.r-project.org/doc/manuals/r-release/R-data.html">R data
          import/export</a></li>

          <li><a href=
          "http://cran.r-project.org/doc/manuals/R-exts.html">Writing R
          extensions</a></li>
        </ul>
      </div>
    </div>

    <div id="outline-container-sec-6" class="outline-2">
      <h2 id="sec-6"><span class="section-number-2">6</span> 1. Getting started
      and getting help</h2>

      <div class="outline-text-2" id="text-6">
        <div class="org-src-container">
          <pre class="src src-R">
?<span class="org-keyword">function</span>
?dataset
package ? lattice
<span class="org-constant">library</span>(help=lattice)
</pre>
        </div>

        <dl class="org-dl">
          <dt><code>args(function)</code></dt>

          <dd>Look at the arguments of a FUNCTION.</dd>
        </dl>

        <p>Other ways:</p>

        <ul class="org-ul">
          <li><a href="http://www.google.com/">Google</a></li>

          <li><a href="mailto:r-help@r-project.org">R general mailing
          list</a></li>

          <li><a href="http://stackoverflow.com/questions/tagged/r">Stack
          Overflow</a></li>
        </ul>
      </div>
    </div>

    <div id="outline-container-sec-7" class="outline-2">
      <h2 id="sec-7"><span class="section-number-2">7</span> 2. Some
      basics</h2>

      <div class="outline-text-2" id="text-7"></div>

      <div id="outline-container-sec-7-1" class="outline-3">
        <h3 id="sec-7-1"><span class="section-number-3">7.1</span> Print
        something</h3>

        <div class="outline-text-3" id="text-7-1">
          <dl class="org-dl">
            <dt><code>print(object)</code></dt>

            <dd>Explicitly print out an object.</dd>

            <dt><code>cat()</code></dt>

            <dd>Concatenate together a set of strings and prints out the
            concatenated string (to a file or to the console).</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-7-2" class="outline-3">
        <h3 id="sec-7-2"><span class="section-number-3">7.2</span> Setting
        variables</h3>

        <div class="outline-text-3" id="text-7-2">
          <dl class="org-dl">
            <dt><code>&lt;-</code></dt>

            <dd>Assign a value to a variable.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-7-3" class="outline-3">
        <h3 id="sec-7-3"><span class="section-number-3">7.3</span> Listing
        variables</h3>

        <div class="outline-text-3" id="text-7-3">
          <dl class="org-dl">
            <dt><code>ls()</code>, <code>ls.str()</code></dt>

            <dd>Show objects in my workspace.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-7-4" class="outline-3">
        <h3 id="sec-7-4"><span class="section-number-3">7.4</span> Deleting
        variables</h3>

        <div class="outline-text-3" id="text-7-4">
          <dl class="org-dl">
            <dt><code>rm()</code></dt>

            <dd>
              <p>Remove objects from your workspace.</p>

              <div class="org-src-container">
                <pre class="src src-R">
rm(list=ls())                      <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">remove everything from the workspace</span>
</pre>
              </div>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-7-5" class="outline-3">
        <h3 id="sec-7-5"><span class="section-number-3">7.5</span> Computing
        basic statistics</h3>

        <div class="outline-text-3" id="text-7-5">
          <dl class="org-dl">
            <dt><code>mean()</code></dt>

            <dd>Take the mean.</dd>

            <dt><code>median()</code></dt>

            <dd>Take the median.</dd>

            <dt><code>cor()</code></dt>

            <dd>Correlation function.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-7-6" class="outline-3">
        <h3 id="sec-7-6"><span class="section-number-3">7.6</span> Creating
        sequences</h3>

        <div class="outline-text-3" id="text-7-6">
          <dl class="org-dl">
            <dt><code>n:m</code></dt>

            <dd>Create an <b>sequence of</b> integers from <code>n</code> to
            <code>m</code> (<code>n</code> &lt; <code>m</code> or
            <code>n</code> &gt; <code>m</code>).</dd>

            <dt><code>seq(from, to, len)</code></dt>

            <dd>Create a <b>sequence of</b> <code>len</code> equally spaced
            fractional numbers.</dd>

            <dt><code>rep(x, times)</code></dt>

            <dd>Create a series of repeated values.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-7-7" class="outline-3">
        <h3 id="sec-7-7"><span class="section-number-3">7.7</span>
        Operators</h3>

        <div class="outline-text-3" id="text-7-7">
          <dl class="org-dl">
            <dt><code>==</code></dt>

            <dd>Compare.</dd>

            <dt><code>%in%</code></dt>

            <dd>Test membership.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-7-8" class="outline-3">
        <h3 id="sec-7-8"><span class="section-number-3">7.8</span> Defining a
        function</h3>

        <div class="outline-text-3" id="text-7-8">
          <div class="org-src-container">
            <pre class="src src-R">
<span class="org-function-name">MyFunction</span> <span class=
"org-constant">&lt;-</span> <span class="org-keyword">function</span>(x) {
  y <span class="org-constant">&lt;-</span> norm(100)
  mean(y)
}
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-8" class="outline-2">
      <h2 id="sec-8"><span class="section-number-2">8</span> 3. Navigating the
      software</h2>

      <div class="outline-text-2" id="text-8">
        <dl class="org-dl">
          <dt><code>library(package)</code></dt>

          <dd>
            <p>Load PACKAGE.</p>

            <div class="org-src-container">
              <pre class="src src-R">
<span class="org-constant">library</span>(datasets)
airquality
</pre>
            </div>
          </dd>

          <dt><code>data(dataset)</code></dt>

          <dd>Load DATASET.</dd>

          <dt><code>source("file.R")</code></dt>

          <dd>Evaluate R code file.</dd>
        </dl>
      </div>

      <div id="outline-container-sec-8-1" class="outline-3">
        <h3 id="sec-8-1"><span class="section-number-3">8.1</span> Running a
        batch script</h3>

        <div class="outline-text-3" id="text-8-1">
          <p>You may write a script containing R code:</p>

          <div class="org-src-container">
            <pre class="src src-sh">
<span class="org-comment-delimiter">#</span><span class=
"org-comment">!/usr/bin/</span><span class="org-keyword">env</span><span class=
"org-comment"> Rscript</span>

argv &lt;- commandArgs<span class=
"org-rainbow-delimiters-depth-1">(</span>TRUE<span class=
"org-rainbow-delimiters-depth-1">)</span>
x &lt;- as.numeric<span class=
"org-rainbow-delimiters-depth-1">(</span>argv<span class=
"org-rainbow-delimiters-depth-2">[</span>1<span class=
"org-rainbow-delimiters-depth-2">]</span><span class=
"org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter"># </span><span class=
"org-comment">etc.</span>

<span class="org-function-name">png</span><span class=
"org-rainbow-delimiters-depth-1">(</span><span class=
"org-string">"graph.png"</span>, 500, 500<span class=
"org-rainbow-delimiters-depth-1">)</span>
<span class="org-function-name">plot</span><span class=
"org-rainbow-delimiters-depth-1">(</span>graph<span class=
"org-rainbow-delimiters-depth-1">)</span>
<span class="org-function-name">graphics.off</span><span class=
"org-rainbow-delimiters-depth-1">()</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-9" class="outline-2">
      <h2 id="sec-9"><span class="section-number-2">9</span> 5. Data
      structures</h2>

      <div class="outline-text-2" id="text-9">
        <p>What is data?</p>

        <dl class="org-dl">
          <dt>Population</dt>

          <dd>Set of items.</dd>

          <dt>Variable</dt>

          <dd>
            Measurement or characteristic.

            <dl class="org-dl">
              <dt>Qualitative</dt>

              <dd>Can be defined by a label and have discrete values.</dd>

              <dt>Quantitative</dt>

              <dd>Measured on a numerical scale.</dd>
            </dl>
          </dd>
        </dl>
      </div>

      <div id="outline-container-sec-9-1" class="outline-3">
        <h3 id="sec-9-1"><span class="section-number-3">9.1</span> Basic
        (“atomic”) vector types</h3>

        <div class="outline-text-3" id="text-9-1">
          <table border="2" cellspacing="0" cellpadding="6" rules="groups"
          frame="hsides">
            <colgroup>
              <col class="left" />
              <col class="left" />
            </colgroup>

            <thead>
              <tr>
                <th scope="col" class="left">Class</th>

                <th scope="col" class="left">Example</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td class="left"><code>logical</code></td>

                <td class="left"><code>TRUE</code> / <code>FALSE</code></td>
              </tr>

              <tr>
                <td class="left"><code>integer</code></td>

                <td class="left"><code>1L</code> (with explicit <code>L</code>
                suffix)</td>
              </tr>

              <tr>
                <td class="left"><code>numeric</code></td>

                <td class="left"><code>0.5</code> or <code>1</code>
                (<i>real</i> numbers)</td>
              </tr>

              <tr>
                <td class="left"><code>complex</code></td>

                <td class="left"><code>1+0i</code></td>
              </tr>

              <tr>
                <td class="left"><code>character</code></td>

                <td class="left">“hello” (= lowest class)</td>
              </tr>
            </tbody>
          </table>

          <dl class="org-dl">
            <dt><code>class()</code></dt>

            <dd>
              <p>Show the class of the object.</p>

              <div class="note">
                <p>Note that an object can belong to more than one class.</p>
              </div>
            </dd>

            <dt><code>unclass(vector)</code></dt>

            <dd>Strip out the class (see factors).</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-9-2" class="outline-3">
        <h3 id="sec-9-2"><span class="section-number-3">9.2</span> Vectors</h3>

        <div class="outline-text-3" id="text-9-2">
          <p><b>Vectors</b> are sets of <b>elements of the same class</b>.</p>

          <p>When objects of different classes are mixed in a vector,
          <i>coercion</i> occurs behind the scene so that every element is of
          the same class (the “lowest common denominator” class).</p>

          <dl class="org-dl">
            <dt><code>c()</code></dt>

            <dd>Create a vector of objects (that is, <b>concatenate</b> or
            combine things together).</dd>

            <dt><code>vector(class, length)</code></dt>

            <dd>Create an empty vector.</dd>

            <dt><code>names()</code></dt>

            <dd>
              <p>Show or give a name to each <b>element</b> of a vector.</p>

              <div class="org-src-container">
                <pre class="src src-R">
names(df) <span class="org-constant">&lt;-</span> tolower(names(df))
</pre>
              </div>
            </dd>

            <dt><code>length()</code></dt>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-9-3" class="outline-3">
        <h3 id="sec-9-3"><span class="section-number-3">9.3</span>
        Matrices</h3>

        <div class="outline-text-3" id="text-9-3">
          <p>Matrices are <b>vectors with 2 dimensions</b> attached to them
          (see <code>dimension</code> attribute).</p>

          <p>They are constructed <i>column-wise</i> (vector inserted by
          column).</p>

          <p>They can be created from vectors by adding a dimension
          attribute:</p>

          <div class="org-src-container">
            <pre class="src src-R">
v <span class="org-constant">&lt;-</span> 1:10
dim(v) <span class="org-constant">&lt;-</span> c(2, 5)
print(v)
</pre>
          </div>

          <table border="2" cellspacing="0" cellpadding="6" rules="groups"
          frame="hsides">
            <colgroup>
              <col class="right" />
              <col class="right" />
              <col class="right" />
              <col class="right" />
              <col class="right" />
            </colgroup>

            <tbody>
              <tr>
                <td class="right">1</td>

                <td class="right">3</td>

                <td class="right">5</td>

                <td class="right">7</td>

                <td class="right">9</td>
              </tr>

              <tr>
                <td class="right">2</td>

                <td class="right">4</td>

                <td class="right">6</td>

                <td class="right">8</td>

                <td class="right">10</td>
              </tr>
            </tbody>
          </table>

          <p>They can be created by <i>column-binding</i> or
          <i>row-binding</i>.</p>

          <dl class="org-dl">
            <dt><code>matrix(nrow=x, ncol=y)</code></dt>

            <dd>Create an empty matrix.</dd>

            <dt><code>cbind()</code></dt>

            <dd>Column-bind (if the row order matches; otherwise, use
            <code>merge</code>).</dd>

            <dt><code>rbind()</code></dt>

            <dd>Row-bind.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-9-4" class="outline-3">
        <h3 id="sec-9-4"><span class="section-number-3">9.4</span> Arrays</h3>

        <div class="outline-text-3" id="text-9-4">
          <p>Arrays are <b>n-dimensional matrices</b>.</p>

          <dl class="org-dl">
            <dt><code>array()</code></dt>

            <dd>Create an array.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-9-5" class="outline-3">
        <h3 id="sec-9-5"><span class="section-number-3">9.5</span> Lists</h3>

        <div class="outline-text-3" id="text-9-5">
          <p><b>Lists</b> are vectors of objects of possibly different
          classes.</p>

          <p>The indexes of the elements of a list have double brackets around
          them.</p>

          <dl class="org-dl">
            <dt><code>list()</code></dt>

            <dd>Construct a list.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-9-6" class="outline-3">
        <h3 id="sec-9-6"><span class="section-number-3">9.6</span> Factors</h3>

        <div class="outline-text-3" id="text-9-6">
          <p><b>Factors</b> are <i>qualitative</i> variables used to represent
          <i>categorical</i> data, to store self-describing codes for
          <i>labels</i> (such as “male” and “female”, or “low”, “medium” and
          “high”).</p>

          <p>Unordered or ordered.</p>

          <dl class="org-dl">
            <dt><code>factor(character vector)</code></dt>

            <dd>Create a factor variable (with levels by alphabetical
            order).</dd>

            <dt><code>levels(x)</code></dt>

            <dd>Return the value of the levels.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-9-7" class="outline-3">
        <h3 id="sec-9-7"><span class="section-number-3">9.7</span> Data
        frames</h3>

        <div class="outline-text-3" id="text-9-7">
          <p><b>Data frames</b> are used to store tabular data where each
          column can be of a different class: special type of <b>list (of
          columns)</b> where every element has the same length.</p>

          <ul class="org-ul">
            <li>Row = observation, column = variable</li>

            <li>Special attribute <code>row.names</code> (every row has a name,
            or defaults to a sequence of integers)</li>

            <li>Most often created by calling <code>read.table()</code> or
            <code>read.csv()</code></li>

            <li id="&lt;code&gt;data.frame()&lt;/code&gt;">
              <p>Create a data frame.</p>

              <div class="org-src-container">
                <pre class="src src-R">
df <span class=
"org-constant">&lt;-</span> data.frame(cbind(v1, v2))    <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">create a dataframe of two vectors</span>
</pre>
              </div>
            </li>

            <li id="&lt;code&gt;data.matrix()&lt;/code&gt;">Convert a data
            frame to a <i>numeric</i> matrix (forced <b>coercion</b>!).</li>

            <li id="&lt;code&gt;names()&lt;/code&gt;">Tell the names of each
            <b>column</b> included in the data frame.</li>
          </ul>
        </div>
      </div>

      <div id="outline-container-sec-9-8" class="outline-3">
        <h3 id="sec-9-8"><span class="section-number-3">9.8</span> Vectorized
        operations (recycling rule)</h3>

        <div class="outline-text-3" id="text-9-8">
          <p>Avoid writing loops (code is a lot simpler):</p>

          <div class="org-src-container">
            <pre class="src src-R">
x + y                                   <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">element-wise addition</span>
</pre>
          </div>

          <p>Similar for the matrices:</p>

          <div class="org-src-container">
            <pre class="src src-R">
x * y                                   <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">element-wise multiplication</span>
x %*% y                                 <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">true matrix multiplication</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-9-9" class="outline-3">
        <h3 id="sec-9-9"><span class="section-number-3">9.9</span> Selecting
        list elements or data frame columns by position (subsetting)</h3>

        <div class="outline-text-3" id="text-9-9">
          <dl class="org-dl">
            <dt><code>[</code></dt>

            <dd>
              <p>Return an <b>object</b> of the <b>same class as the
              original</b>: a list of elements (or a data frame built from
              multiple columns). The data type is <b>preserved</b>.</p>

              <p>Extract multiple elements of a list:</p>

              <div class="org-src-container">
                <pre class="src src-R">
x[c(1, 3)]
</pre>
              </div>

              <p>Remove the first column:</p>

              <div class="org-src-container">
                <pre class="src src-R">
df[, -1]
</pre>
              </div>
            </dd>

            <dt><code>[[</code></dt>

            <dd>
              <p>Extract a <b>single element of a list</b> (or a single column
              of a data frame) <b>by index</b>.</p>

              <p>Can be used with <i>computed</i> indices.</p>

              <p>Can extract nested elements of a list:</p>

              <div class="org-src-container">
                <pre class="src src-R">
x[[1]][[3]]                        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">same as: x[[c(1, 3)]]</span>
                                   <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">third element of the first element</span>
</pre>
              </div>

              <p>Partial matching allowed at the command-line:</p>

              <div class="org-src-container">
                <pre class="src src-R">
x[[<span class="org-string">"a"</span>, exact=<span class=
"org-type">FALSE</span>]]              <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">instead of: x[["aardvark"]]</span>
</pre>
              </div>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-9-10" class="outline-3">
        <h3 id="sec-9-10"><span class="section-number-3">9.10</span> Selecting
        list elements or data frame columns by name (subsetting)</h3>

        <div class="outline-text-3" id="text-9-10">
          <dl class="org-dl">
            <dt><code>$</code></dt>

            <dd>
              <p>Extract a <b>single element of a list</b> (or a single column
              of a data frame) <b>by name</b>: you don’t have to remember where
              the element is in the list.</p>

              <div class="org-src-container">
                <pre class="src src-R">
x$bar                              <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">same as x[["bar"]]</span>
</pre>
              </div>

              <p>Can only be used with literal names.</p>

              <p>Partial matching allowed at the command-line:</p>

              <div class="org-src-container">
                <pre class="src src-R">
x$a                                <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">instead of: x$aardvark</span>
</pre>
              </div>
            </dd>
          </dl>

          <div class="note">
            <p>The only (typical data) class that uses <code>$</code> as a
            accessor is <b>list</b> (from which <b>dataframes</b> inherit).
            Hence, you can’t use <code>$</code> notation with <b>matrices</b>.
            You need to use <code>x["ratio"]</code> or
            <code>x[["ratio"]]</code>.</p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-9-11" class="outline-3">
        <h3 id="sec-9-11"><span class="section-number-3">9.11</span> Selecting
        data frame columns by position (subsetting)</h3>

        <div class="outline-text-3" id="text-9-11">
          <p>Matrices can be subsetted with <code>(row, col)</code> type
          indices.</p>

          <p>Indices can also be missing:</p>

          <dl class="org-dl">
            <dt><code>x[i, ]</code></dt>

            <dd>Row i.</dd>

            <dt><code>x[, j]</code></dt>

            <dd>Column j.</dd>
          </dl>

          <p>By default,</p>

          <ul class="org-ul">
            <li>a single element is retrieved as a vector of length 1 rather
            than a 1x1 matrix.</li>

            <li>a single column or a single row is retrieved as a vector, not
            as a matrix.</li>
          </ul>

          <p>This can be turned off by setting <code>drop = FALSE</code> (don’t
          drop the dimension).</p>
        </div>
      </div>

      <div id="outline-container-sec-9-12" class="outline-3">
        <h3 id="sec-9-12"><span class="section-number-3">9.12</span> Flatten a
        list into a vector</h3>

        <div class="outline-text-3" id="text-9-12">
          <dl class="org-dl">
            <dt><code>unlist</code></dt>

            <dd>Flatten the <b>list into</b> a <b>vector</b> (for functions
            which work on vectors but not on lists.)</dd>
          </dl>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-10" class="outline-2">
      <h2 id="sec-10"><span class="section-number-2">10</span> Control
      structures</h2>

      <div class="outline-text-2" id="text-10">
        <p>Control structures mentioned here are primarily useful for writing
        programs. For command-line interactive work, the <code>*apply</code>
        functions are more useful.</p>
      </div>

      <div id="outline-container-sec-10-1" class="outline-3">
        <h3 id="sec-10-1"><span class="section-number-3">10.1</span>
        Conditional statements</h3>

        <div class="outline-text-3" id="text-10-1">
          <div class="org-src-container">
            <pre class="src src-R">
<span class="org-keyword">if</span> (condition) {
  <span class="org-comment-delimiter">## </span><span class=
"org-comment">do something</span>
} <span class="org-keyword">else</span> {
  <span class="org-comment-delimiter">## </span><span class=
"org-comment">do something else</span>
}
</pre>
          </div>

          <p>Here, the entire <code>if/else</code> construct is all about
          assigning a value to <code>y</code>:</p>

          <div class="org-src-container">
            <pre class="src src-R">
y <span class="org-constant">&lt;-</span> <span class=
"org-keyword">if</span>(x &gt; 3) {                        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">x must be a scalar here, not a vector</span>
  10
} <span class="org-keyword">else</span> {
  0
}
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-10-2" class="outline-3">
        <h3 id="sec-10-2"><span class="section-number-3">10.2</span> Loops</h3>

        <div class="outline-text-3" id="text-10-2">
          <p>Loop over the <b>elements</b>:</p>

          <div class="org-src-container">
            <pre class="src src-R">
<span class="org-keyword">for</span> (x <span class=
"org-keyword">in</span> xs) {                         <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">take elements from the vector</span>
  <span class="org-comment-delimiter">## </span><span class=
"org-comment">do something</span>
}
</pre>
          </div>

          <p>Loop over the <b>numeric indices</b>:</p>

          <div class="org-src-container">
            <pre class="src src-R">
<span class="org-keyword">for</span> (i <span class=
"org-keyword">in</span> seq_along(xs)) {              <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">successive values from a sequence or</span>
  <span class="org-comment-delimiter">## </span><span class=
"org-comment">do something                       # vector</span>
}
</pre>
          </div>

          <dl class="org-dl">
            <dt><code>seq_along(vector)</code></dt>

            <dd>Create an integer sequence that’s equal to the <b>length of the
            input vector</b>.</dd>

            <dt><code>seq_len(integer)</code></dt>

            <dd>Create an integer sequence that’s as long as the integer in
            input.</dd>

            <dt><code>nrow(dataset)</code></dt>

            <dd>Tell the number of rows.</dd>

            <dt><code>ncol(dataset)</code></dt>

            <dd>Tell the number of columns.</dd>
          </dl>

          <p>Loop over the <b>names</b>:</p>

          <div class="org-src-container">
            <pre class="src src-R">
<span class="org-keyword">for</span> (nm <span class=
"org-keyword">in</span> names(xs)) {
  <span class="org-comment-delimiter">## </span><span class=
"org-comment">do something</span>
}
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-R">
<span class=
"org-keyword">while</span> (z &gt;= 3 &amp;&amp; z &lt;= 10) {             <span class="org-comment-delimiter"># </span><span class="org-comment">conditions are always evaluated from</span>
                                        <span class=
"org-comment-delimiter"># </span><span class="org-comment">left to right</span>
  <span class="org-comment-delimiter">## </span><span class=
"org-comment">do something</span>
}
</pre>
          </div>

          <p>Initiate an infinite loop:</p>

          <div class="org-src-container">
            <pre class="src src-R">
<span class="org-keyword">repeat</span> {
  <span class="org-comment-delimiter">## </span><span class=
"org-comment">do something</span>
  <span class="org-keyword">if</span>(&lt;condition&gt;) {
    <span class=
"org-keyword">break</span>                               <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">only way to exit a repeat loop</span>
  }
}
</pre>
          </div>

          <dl class="org-dl">
            <dt><code>break</code></dt>

            <dd>Break the iteration of a loop.</dd>

            <dt><code>next</code></dt>

            <dd>Skip an iteration of a loop.</dd>

            <dt><code>return</code></dt>

            <dd>Exit an entire function and return a given value.</dd>
          </dl>

          <p>Better to use a <code>for</code> loop with an hard limit on the
          number of iterations that it’s allowed to run.</p>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-11" class="outline-2">
      <h2 id="sec-11"><span class="section-number-2">11</span> Writing
      functions</h2>

      <div class="outline-text-2" id="text-11">
        <ul class="org-ul">
          <li>
            <p>Functions are R objects of class <code>function</code></p>

            <div class="org-src-container">
              <pre class="src src-R">
<span class="org-function-name">MyFunction</span> <span class=
"org-constant">&lt;-</span> <span class=
"org-keyword">function</span>(arguments) {
  <span class="org-comment-delimiter"># </span><span class=
"org-comment">Function documentation.</span>
  <span class="org-comment-delimiter">## </span><span class=
"org-comment">do something</span>
}
</pre>
            </div>
          </li>

          <li>Functions can be <b>passed as arguments to other
          functions</b></li>

          <li>Functions can be nested, so that you can define a function inside
          of another function (implications: see <b>lexical scoping</b>)</li>

          <li>The return value of a function is the last expression in the
          function body to be evaluated</li>

          <li>3 types of…

            <ul class="org-ul">
              <li>formal argument</li>

              <li>local variable</li>

              <li>free variable</li>
            </ul>
          </li>
        </ul>
      </div>

      <div id="outline-container-sec-11-1" class="outline-3">
        <h3 id="sec-11-1"><span class="section-number-3">11.1</span>
        Arguments</h3>

        <div class="outline-text-3" id="text-11-1">
          <ul class="org-ul">
            <li><i>Named arguments</i> can potentially have <i>default
            values</i> (useful: not every function call makes use of all the
            formal arguments; some can be <i>missing</i>)</li>

            <li>The <i>formal arguments</i> are the arguments included in the
            function definition</li>

            <li><code>formals()</code> returns a list of all the formal
            arguments of a function</li>

            <li>Arguments can be matched <b>positionally</b> or <b>by name</b>

              <ul class="org-ul">
                <li>When an argument is matched by name, it is “taken out” of
                the argument list and the remaining unnamed arguments are
                matched in the order that they are listed in the function
                definition</li>
              </ul>
            </li>

            <li>Named arguments help when:

              <ul class="org-ul">
                <li>you want to use the defaults for everything except for an
                argument near the end of the list</li>

                <li>you can’t remember the position of the argument</li>
              </ul>
            </li>

            <li>Function arguments can also be partially <i>matched</i>

              <ol class="org-ol">
                <li>Check for an exact match</li>

                <li>Check for a partial match</li>

                <li>Check for a positional match</li>
              </ol>
            </li>

            <li>When defining a function, you can also set an argument value to
            <code>NULL</code> (there is nothing there)</li>

            <li>Arguments to functions are evaluated <i>lazily</i> (only when
            needed to be evaluated</li>

            <li>The <code>...</code> argument indicates a variable number of
            arguments

              <ul class="org-ul">
                <li>Used when extending a function and you don’t want to copy
                the entire argument list of the original function</li>

                <li>Used by generic functions (such as <code>mean</code>) so
                that extra arguments can be passed to methods</li>

                <li>Used when the number of arguments cannot be known in
                advance (see <code>paste</code> function)</li>

                <li>Any argument that appears <i>after</i> the <code>...</code>
                must be named explicitly and cannot be partially matched</li>
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <div id="outline-container-sec-11-2" class="outline-3">
        <h3 id="sec-11-2"><span class="section-number-3">11.2</span> Scoping
        rules for R</h3>

        <div class="outline-text-3" id="text-11-2">
          <ul class="org-ul">
            <li>R searches through the <i>search list</i> (a series of
            <code>environments</code>, an environment being a collection of
            symbol/value pairs) to bind the appropriate value to a symbol:

              <ul class="org-ul">
                <li>Search the global environment <code>.GlobalEnv</code>
                (always the first)</li>

                <li>
                  <p>Search the namespaces of each of the packages on the
                  search list</p>

                  <div class="org-src-container">
                    <pre class="src src-R">
search()                            <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">find the search list</span>
</pre>
                  </div>
                </li>

                <li>Search the <code>base</code> package (always the last
                element)</li>
              </ul>
            </li>

            <li>Last loaded package gets put in position 2 of the search list
            and everything else gets shifted</li>

            <li>Separate namespaces for functions and non-function objects</li>

            <li>R uses <b>lexical</b> (or <i>static</i>) <b>scoping</b>
            (instead of <i>dynamic scoping</i>): <i>the value of free variables
            are searched for in the environment in which the function</i>
            <i>was</i> <b>defined</b> (until the empty environment, after the
            <code>base</code> package)

              <ul class="org-ul">
                <li>With <b>dynamic</b> scoping, the value of free variables is
                looked up in the environment from which the function was
                <b>called</b> (<i>calling environment</i> = <i>parent
                frame</i>) – see slide 24 of “Scoping Rules for R” for a
                comparative example</li>

                <li>Other languages that support lexical scoping: Scheme, Perl,
                Python, Common Lisp</li>

                <li>Consequences: all objects must be stored in memory, and all
                functions must carry a <b>pointer to their respective defining
                environment</b></li>
              </ul>
            </li>

            <li>Every environment has one parent environment (next thing down
            on the search list); it is possible for an environment to have
            mulitple “children”</li>

            <li>A function + an environment = a (<i>function</i>)
            <i>closure</i></li>

            <li>
              <p>In R (unlike C), you can have functions defined <i>inside
              other functions</i> – in this case, the environment in which a
              function is defined is the body of another function!</p>

              <div class="org-src-container">
                <pre class="src src-R">
<span class="org-function-name">make.power</span> <span class=
"org-constant">&lt;-</span> <span class=
"org-keyword">function</span>(n) {           <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">"constructor" function</span>
  <span class="org-function-name">pow</span> <span class=
"org-constant">&lt;-</span> <span class="org-keyword">function</span>(x) {
    x^n                               <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">n is a free variable (not defined</span>
                                      <span class=
"org-comment-delimiter"># </span><span class="org-comment">inside pow)</span>
  }
  pow                                 <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">return function as return value</span>
}
</pre>
              </div>

              <p>This function returns another function as its value</p>

              <div class="org-src-container">
                <pre class="src src-R">
cube <span class="org-constant">&lt;-</span> make.power(3)
square <span class="org-constant">&lt;-</span> make.power(2)
</pre>
              </div>
            </li>

            <li>Functions:

              <dl class="org-dl">
                <dt><code>environment(f)</code></dt>

                <dt><code>parent.env(environment)</code></dt>

                <dd>Next thing down on the search list</dd>

                <dt><code>ls(environment)</code></dt>

                <dd>List all the variables in the environment</dd>

                <dt><code>get(object, environment)</code></dt>

                <dd>Get the value of an object inside an environment</dd>
              </dl>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-12" class="outline-2">
      <h2 id="sec-12"><span class="section-number-2">12</span> 4. Input and
      output</h2>

      <div class="outline-text-2" id="text-12">
        <p>Types of files:</p>

        <ul class="org-ul">
          <li>Tab-delimited</li>

          <li>CSV</li>

          <li>Excel</li>

          <li>JSON</li>

          <li>HTML/XML</li>

          <li>Database</li>
        </ul>
      </div>

      <div id="outline-container-sec-12-1" class="outline-3">
        <h3 id="sec-12-1"><span class="section-number-3">12.1</span> Getting
        the current working directory</h3>

        <div class="outline-text-3" id="text-12-1">
          <dl class="org-dl">
            <dt><code>getwd()</code></dt>

            <dd>Figure out what your <b>working directory</b> is.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-12-2" class="outline-3">
        <h3 id="sec-12-2"><span class="section-number-3">12.2</span> Creating,
        opening and closing connections</h3>

        <div class="outline-text-3" id="text-12-2">
          <dl class="org-dl">
            <dt><code>file()</code></dt>

            <dd>
              <ul class="org-ul">
                <li><code>description</code> is the name of the file</li>

                <li><code>open</code> is a code (read-only, write, append)</li>
              </ul>

              <div class="org-src-container">
                <pre class="src src-R">
con <span class="org-constant">&lt;-</span> file(<span class=
"org-string">"./data/cameras.csv"</span>, <span class="org-string">"r"</span>)
cameraData <span class="org-constant">&lt;-</span> read.csv(con)
close(con)
</pre>
              </div>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-12-3" class="outline-3">
        <h3 id="sec-12-3"><span class="section-number-3">12.3</span> Reading
        tabular data files</h3>

        <div class="outline-text-3" id="text-12-3">
          <dl class="org-dl">
            <dt><code>read.table(file)</code></dt>

            <dd>
              <p>Read tabular data file, create data frame.</p>

              <p>Important arguments:</p>

              <ul class="org-ul">
                <li><code>file</code></li>

                <li><code>header</code></li>

                <li><code>sep</code> (defaults to the <b>space</b>)</li>

                <li><code>quote</code></li>

                <li><code>colClasses</code> (class of each column, also used to
                <b>skip columns</b>)</li>

                <li><code>nrows</code></li>

                <li><code>skip</code> (number of lines to skip from the
                beginning)</li>

                <li><code>comment.char</code></li>

                <li><code>stringsAsFactors</code> (defaults to
                <code>TRUE</code>)</li>

                <li><code>text</code> to <b>feed your data text
                representation</b> directly to <code>read.table</code></li>
              </ul>

              <div class="org-src-container">
                <pre class="src src-R">
data <span class="org-constant">&lt;-</span> read.table(<span class=
"org-string">"./data/file.txt"</span>, header=T, sep=<span class=
"org-string">"\t"</span>, quote=<span class="org-string">""</span>)
</pre>
              </div>
            </dd>
          </dl>

          <p>For <b>large datasets</b>:</p>

          <ul class="org-ul">
            <li>Set <code>comment.char</code> = "" if there are no comments in
            your file.</li>

            <li>
              <p>Use the <code>colClasses</code> argument.</p>

              <p>Quick and dirty way to figure out the classes of each column
              (if there aren’t any classes that you want to change from their
              defaults): read in the first rows, <i>determine the classes from
              that</i>, and then import the rest of the file.</p>

              <div class="org-src-container">
                <pre class="src src-R">
tabSample <span class="org-constant">&lt;-</span> read.table(<span class=
"org-string">"datatable.txt"</span>, nrows=100)
classes <span class="org-constant">&lt;-</span> sapply(tabSample, class)
tabAll <span class="org-constant">&lt;-</span> read.table(<span class=
"org-string">"datatanble.txt"</span>, colClasses=classes)
                                      <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">save time on importing data</span>
</pre>
              </div>
            </li>

            <li>Set <code>nrows</code> helps with memory usage.</li>
          </ul>

          <p>R equivalent of Linux <code>cut</code> (to read only certain
          columns from a file):</p>

          <div class="org-src-container">
            <pre class="src src-R">
whichCols <span class="org-constant">&lt;-</span> rep(<span class=
"org-string">"NULL"</span>, 28)            <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">assuming 28 colums</span>
whichCols[c(1, 5, 28)] <span class="org-constant">&lt;-</span> <span class=
"org-type">NA</span>
df <span class=
"org-constant">&lt;-</span> read.table(file, colClasses=whichCols)
</pre>
          </div>

          <p>To call some shell script to do the column extraction and then
          using <code>read.table</code> on its output:</p>

          <div class="org-src-container">
            <pre class="src src-R">
df <span class="org-constant">&lt;-</span> read.table(pipe(<span class=
"org-string">"cut -f1,5,28 myFile.txt"</span>))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-12-4" class="outline-3">
        <h3 id="sec-12-4"><span class="section-number-3">12.4</span> Writing
        tabular data files</h3>

        <div class="outline-text-3" id="text-12-4">
          <dl class="org-dl">
            <dt><code>write.table()</code></dt>

            <dd>Write data.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-12-5" class="outline-3">
        <h3 id="sec-12-5"><span class="section-number-3">12.5</span> Reading
        from CSV files</h3>

        <div class="outline-text-3" id="text-12-5">
          <dl class="org-dl">
            <dt><code>read.csv(file)</code></dt>

            <dd>
              <p>Read data from CSV file, create data frame.</p>

              <ul class="org-ul">
                <li><code>header</code> (defaults to <code>TRUE</code>)</li>

                <li><code>separator</code> (defaults to <b>comma</b>)</li>

                <li><code>na.strings</code> (“NULL”, defaults to “NA”)</li>
              </ul>

              <div class="org-src-container">
                <pre class="src src-R">
data <span class="org-constant">&lt;-</span> read.csv(<span class=
"org-string">"./data/file.csv"</span>)

read.csv(file.choose())            <span class=
"org-comment-delimiter"># </span><span class="org-comment">pick a file</span>
</pre>
              </div>

              <p>It calls <code>read.table</code> with some default values. To
              look at them, just look at the code of <code>read.csv</code> by
              typing <code>read.csv</code> and hitting &lt;enter&gt; at your R
              command line).</p>
            </dd>

            <dt><code>read.csv2(file)</code></dt>

            <dd>
              Read data from CSV file, create data frame.

              <ul class="org-ul">
                <li><code>header</code> (defaults to <code>TRUE</code>)</li>

                <li><code>separator</code> (defaults to <code>;</code>)</li>
              </ul>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-12-6" class="outline-3">
        <h3 id="sec-12-6"><span class="section-number-3">12.6</span> Reading
        from Excel files</h3>

        <div class="outline-text-3" id="text-12-6">
          <dl class="org-dl">
            <dt><code>read.xlsx()</code>, <code>read.xlsx2()</code></dt>

            <dd>Read Excel files.</dd>
          </dl>

          <p>You can also read from Excel spreadsheets using RODBC and
          <code>sqlQuery</code>.</p>
        </div>
      </div>

      <div id="outline-container-sec-12-7" class="outline-3">
        <h3 id="sec-12-7"><span class="section-number-3">12.7</span> Reading
        files from the Internet</h3>

        <div class="outline-text-3" id="text-12-7">
          <dl class="org-dl">
            <dt><code>download.file()</code></dt>

            <dd>
              <p>Download a file from the Internet.</p>

              <p>Be sure to record when you downloaded it.</p>

              <div class="org-src-container">
                <pre class="src src-R">
fileUrl <span class="org-constant">&lt;-</span> <span class=
"org-string">"http://..."</span>
download.file(fileUrl, destfile=<span class=
"org-string">"./data/file.csv"</span>, method=<span class=
"org-string">"curl"</span>)
</pre>
              </div>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-12-8" class="outline-3">
        <h3 id="sec-12-8"><span class="section-number-3">12.8</span> Reading
        files with a complex structure</h3>

        <div class="outline-text-3" id="text-12-8">
          <dl class="org-dl">
            <dt><code>readLines()</code></dt>

            <dd>
              <p>Read lines of text from a connection.</p>

              <p><i>Connections</i> can be made to:</p>

              <ul class="org-ul">
                <li><code>file</code> (most common)</li>

                <li><code>gzfile</code>, file compressed with
                <code>gzip</code></li>

                <li><code>bzfile</code>, file compressed with
                <code>bzip2</code></li>

                <li><code>url</code></li>
              </ul>

              <p><b>Remember to close connections</b>.</p>

              <div class="org-src-container">
                <pre class="src src-R">
con <span class="org-constant">&lt;-</span> url(<span class=
"org-string">"http://scholar.google.com/citations"</span>)
htmlCode <span class="org-constant">&lt;-</span> readLines(con)
close(con)

<span class="org-comment-delimiter"># </span><span class=
"org-comment">get data off webpages</span>
html3 <span class="org-constant">&lt;-</span> htmlTreeParse(<span class=
"org-string">"..."</span>)

<span class="org-comment-delimiter"># </span><span class=
"org-comment">find value of title tag</span>
xpathSApply(html3, <span class="org-string">"//title"</span>, xmlValue)

<span class="org-comment-delimiter"># </span><span class=
"org-comment">access parts of the table</span>
xpathSApply(html3, <span class=
"org-string">"//td[@id='col-citedby']"</span>, xmlValue)
</pre>
              </div>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-12-9" class="outline-3">
        <h3 id="sec-12-9"><span class="section-number-3">12.9</span> Reading
        from SQL Server databases</h3>

        <div class="outline-text-3" id="text-12-9">
          <div class="org-src-container">
            <pre class="src src-R">
<span class="org-comment-delimiter">## </span><span class=
"org-comment">install.packages("RODBC")</span>
<span class="org-constant">library</span>(RODBC)

<span class="org-comment-delimiter">## </span><span class=
"org-comment">channel &lt;- odbcConnect("DSN", uid="username", pwd="password")</span>
<span class="org-comment-delimiter">## </span><span class=
"org-comment">channel &lt;- odbcDriverConnect("driver={SQL Server};server=hostname;database=dbname;trusted_connection=true")</span>
channel <span class="org-constant">&lt;-</span> odbcDriverConnect(<span class=
"org-string">"driver={SQL Server};server=hostname;database=dbname;uid=username;pwd=password"</span>)

<span class="org-comment-delimiter"># </span><span class=
"org-comment">Check that connection is working.</span>
<span class="org-keyword">if</span> (channel == -1L) {
  <span class="org-keyword">stop</span>(<span class=
"org-string">"Error establishing an ODBC connection."</span>)
} <span class="org-keyword">else</span>
  odbcGetInfo(channel)

sql <span class="org-constant">&lt;-</span>
 <span class="org-string">"SELECT *</span>
<span class="org-string">  FROM table"</span>
sql <span class="org-constant">&lt;-</span> gsub(<span class=
"org-string">"\n"</span>, <span class=
"org-string">" "</span>, sql)             <span class=
"org-comment-delimiter"># </span><span class="org-comment">optional</span>

df <span class="org-constant">&lt;-</span> sqlQuery(channel, sql)

<span class=
"org-keyword">if</span> (is.character(df)) {                 <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">SQL error (no data frame returned)</span>
  <span class="org-keyword">stop</span>(paste(df, collapse=<span class=
"org-string">"\n"</span>))
} <span class="org-keyword">else</span> <span class=
"org-keyword">if</span> (nrow(df) == 0) {
  cat(<span class="org-string">"No data\n"</span>)
} <span class="org-keyword">else</span>
  print(head(df))

odbcClose(channel)
</pre>
          </div>

          <div class="tip">
            <ul class="org-ul">
              <li>Check the class of each column with <code>lapply(df,
              class)</code>!</li>

              <li>Display the factor columns with <code>df[sapply(df,
              is.factor)]</code>!</li>
            </ul>
          </div>

          <div class="org-src-container">
            <pre class="src src-R">
<span class=
"org-keyword">if</span> (transaction) sqlQuery(channel, <span class="org-string">'START TRANSACTION'</span>)

<span class="org-keyword">if</span> (success &amp; transaction) {
  sqlQuery(channel, <span class="org-string">'COMMIT'</span>)
} <span class="org-keyword">else</span> <span class=
"org-keyword">if</span> (transaction){
  sqlQuery(channel, <span class="org-string">'ROLLBACK'</span>)
}
</pre>
          </div>

          <p>There is a convergence movement to the DBI package.</p>

          <p><a href="https://github.com/agstudy/rsqlserver">rsqlserver</a> is
          part of it, but it is less mature than RODBC (though it’s still high
          quality).</p>
        </div>
      </div>

      <div id="outline-container-sec-12-10" class="outline-3">
        <h3 id="sec-12-10"><span class="section-number-3">12.10</span> Saving
        and transporting objects</h3>

        <div class="outline-text-3" id="text-12-10">
          <p>Textual formats (potentially recoverable in case of
          corruption).</p>

          <dl class="org-dl">
            <dt><code>dput()</code></dt>

            <dd>Deparse a single R object.</dd>

            <dt><code>dump()</code></dt>

            <dd>Can be used on multiple R objects.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-12-11" class="outline-3">
        <h3 id="sec-12-11"><span class="section-number-3">12.11</span> Further
        resources</h3>

        <div class="outline-text-3" id="text-12-11">
          <p>Packages:</p>

          <dl class="org-dl">
            <dt><code>httr</code></dt>

            <dd>For working with HTTP connections.</dd>

            <dt><code>RMySQL</code></dt>

            <dd>For interfacing with mySQL.</dd>

            <dt><code>bigmemory</code></dt>

            <dd>For handling data larger than RAM.</dd>

            <dt><code>foreign</code></dt>

            <dd>For getting data into R from SAS, SPSS, Octave, etc.</dd>
          </dl>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-13" class="outline-2">
      <h2 id="sec-13"><span class="section-number-2">13</span> 12. Useful
      tricks</h2>

      <div class="outline-text-2" id="text-13"></div>

      <div id="outline-container-sec-13-1" class="outline-3">
        <h3 id="sec-13-1"><span class="section-number-3">13.1</span> Peeking at
        your data</h3>

        <div class="outline-text-3" id="text-13-1">
          <dl class="org-dl">
            <dt><code>head()</code></dt>

            <dd>Look at the first 6 rows.</dd>

            <dt><code>tail()</code></dt>

            <dd>Look at the last 6 rows.</dd>

            <dt><code>str()</code></dt>

            <dd>
              <p><i>Compactly</i> display the internal <b>structure</b>
              (<b>classes</b>, etc.) of an object.</p>

              <p>Alternative to <code>summary()</code>.</p>

              <p>When applied to functions, show the <b>arguments</b>.</p>

              <div class="org-src-container">
                <pre class="src src-R">
str(.Platform)                     <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">what is the operating system</span>
</pre>
              </div>
            </dd>

            <dt><code>attributes()</code></dt>

            <dd>Access (set or modify) the (list of) attributes of an
            object.</dd>
          </dl>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-14" class="outline-2">
      <h2 id="sec-14"><span class="section-number-2">14</span> 9. General
      statistics</h2>

      <div class="outline-text-2" id="text-14"></div>

      <div id="outline-container-sec-14-1" class="outline-3">
        <h3 id="sec-14-1"><span class="section-number-3">14.1</span>
        Summarizing your data</h3>

        <div class="outline-text-3" id="text-14-1">
          <dl class="org-dl">
            <dt><code>range()</code></dt>

            <dd>
              <p>Give the <b>min</b> and the <b>max</b> (vector 2 elements) of
              the observations (vector of numbers).</p>

              <p>Useful to give the <b>extremes of a range to the
              <code>xlim</code> and <code>ylim</code> arguments</b> of an
              axis.</p>

              <div class="org-src-container">
                <pre class="src src-R">
yrange <span class="org-constant">&lt;-</span> range(c(x1, x2, x3))
</pre>
              </div>
            </dd>

            <dt><code>summary()</code></dt>

            <dd>
              <p>Produce a summary of the object.</p>

              <p>Display the <b>number of NA values</b> in each column.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-14-2" class="outline-3">
        <h3 id="sec-14-2"><span class="section-number-3">14.2</span> Tabulating
        factors</h3>

        <div class="outline-text-3" id="text-14-2">
          <dl class="org-dl">
            <dt><code>table(f)</code></dt>

            <dd>
              <p><b>Count</b> the number of observations in each <i>level</i>
              (only works on <i>factors</i>). Give a <b>frequency</b> of how
              many levels there are.</p>

              <div class="org-src-container">
                <pre class="src src-R">
unique(df$f)
length(unique(df$f))               <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">how many unique values</span>

table(df$f, useNA=<span class="org-string">"ifany"</span>)         <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">number of times each unique value</span>
                                   <span class=
"org-comment-delimiter">#  </span><span class=
"org-comment">appears (show missing values as well)</span>
</pre>
              </div>

              <p>Relative frequencies:</p>

              <div class="org-src-container">
                <pre class="src src-R">
tbl <span class="org-constant">&lt;-</span> table(df$f, useNA=<span class=
"org-string">"ifany"</span>)
tbl / sum(tbl)
</pre>
              </div>

              <p>Use the <code>cut</code> function to calculate tables with
              <i>numeric</i> values.</p>

              <div class="org-src-container">
                <pre class="src src-R">
f <span class=
"org-constant">&lt;-</span> cut(df$x, breaks=30)          <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">use `labels' to give nice names</span>
table(f, useNA=<span class="org-string">"ifany"</span>)
</pre>
              </div>

              <p>Draw a useful graphical summary (to describe proportions):</p>

              <div class="org-src-container">
                <pre class="src src-R">
pie(table(df$x))
pie(sort(table(df$x)))             <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">bigger and bigger</span>
</pre>
              </div>
            </dd>

            <dt><code>table(f1, f2)</code></dt>

            <dd>
              <p>Produce a <i>contingency table</i> (cross-tabulation).</p>

              <div class="org-src-container">
                <pre class="src src-R">
table(df$f1, df$f2)                <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">look at the relationship between f1</span>
                                   <span class=
"org-comment-delimiter"># </span><span class="org-comment">and f2</span>
</pre>
              </div>
            </dd>

            <dt><code>ftable(f)</code></dt>

            <dd>3-dimensional contingency table.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-14-3" class="outline-3">
        <h3 id="sec-14-3"><span class="section-number-3">14.3</span> Testing
        categorical variables for independence</h3>

        <div class="outline-text-3" id="text-14-3">
          <div class="org-src-container">
            <pre class="src src-R">
summary(table(f1, f2))
</pre>
          </div>

          <p>Conventionally, a <i>p</i>-value of less than 0.05 indicates that
          the variables are likely not independent (there is some connection
          between the variables).</p>
        </div>
      </div>

      <div id="outline-container-sec-14-4" class="outline-3">
        <h3 id="sec-14-4"><span class="section-number-3">14.4</span>
        Calculating quantiles (and quartiles) of a dataset</h3>

        <div class="outline-text-3" id="text-14-4">
          <div class="org-src-container">
            <pre class="src src-R">
quantile(vec, na.rm=<span class="org-type">TRUE</span>)
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-15" class="outline-2">
      <h2 id="sec-15"><span class="section-number-2">15</span> 6. Data
      transformations</h2>

      <div class="outline-text-2" id="text-15">
        <p>(Partial list of) munging operations (= key process)</p>

        <ul class="org-ul">
          <li><b>These steps must be recorded</b> in their own R script</li>

          <li><b>90% of your effort will often be spent here</b></li>
        </ul>

        <p>Processed (<b>tidy</b>) data:</p>

        <ul class="org-ul">
          <li>Each variable forms a column.</li>

          <li>Each observation forms a row.</li>

          <li>Each table / file stores data about one kind of observation.</li>
        </ul>
      </div>

      <div id="outline-container-sec-15-1" class="outline-3">
        <h3 id="sec-15-1"><span class="section-number-3">15.1</span> Fixing
        variable names</h3>

        <div class="outline-text-3" id="text-15-1">
          <div class="org-src-container">
            <pre class="src src-R">
tolower(names(df))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-R">
splitNames <span class=
"org-constant">&lt;-</span> strsplit(names(df), <span class=
"org-string">"\\."</span>) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">split at period in names</span>
<span class="org-function-name">firstElement</span> <span class=
"org-constant">&lt;-</span> <span class=
"org-keyword">function</span>(x) x[1]        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">select the 1st component of the vector</span>
sapply(splitNames, firstElement)        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">remove everything after the trailing</span>
                                        <span class=
"org-comment-delimiter"># </span><span class="org-comment">dot</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-R">
gsub(<span class="org-string">"_"</span>, <span class=
"org-string">""</span>, names(df))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-2" class="outline-3">
        <h3 id="sec-15-2"><span class="section-number-3">15.2</span> Creating
        new variables</h3>

        <div class="outline-text-3" id="text-15-2">
          <div class="org-src-container">
            <pre class="src src-R">
df$ranges <span class=
"org-constant">&lt;-</span> ranges                     <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">add a variable to the data frame</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-3" class="outline-3">
        <h3 id="sec-15-3"><span class="section-number-3">15.3</span> Change the
        class of many columns from factor to character (or numeric)</h3>

        <div class="outline-text-3" id="text-15-3">
          <div class="org-src-container">
            <pre class="src src-R">
unfactor.cols <span class="org-constant">&lt;-</span> c(<span class=
"org-string">"V1"</span>, <span class="org-string">"V2"</span>)
d[, unfactor.cols] <span class=
"org-constant">&lt;-</span> lapply(unfactor.cols,
                           <span class=
"org-keyword">function</span>(x) as.character(d[, x]))
</pre>
          </div>

          <p>Add <code>as.numeric</code> to convert them to numeric (may induce
          <code>NA</code>).</p>

          <div class="org-src-container">
            <pre class="src src-R">
<span class="org-comment-delimiter">## </span><span class=
"org-comment">Convert all factors from a data frame to character</span>
<span class="org-function-name">unfactor</span> <span class=
"org-constant">&lt;-</span> <span class="org-keyword">function</span> (df) {
  cols <span class=
"org-constant">&lt;-</span> sapply(df, is.factor)         <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">find the factors</span>
  df[cols] <span class=
"org-constant">&lt;-</span> lapply(df[cols], as.character) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">convert to character</span>
  df
}
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-4" class="outline-3">
        <h3 id="sec-15-4"><span class="section-number-3">15.4</span> Removing
        list elements using a condition</h3>

        <div class="outline-text-3" id="text-15-4">
          <p><b>Subsetting</b> by using 2 types of index:</p>

          <ul class="org-ul">
            <li>a numeric vector (<code>x[2]</code>, <code>x[1:4]</code>)</li>

            <li>a <b>logical vector</b> (<code>x[x &gt; "a"]</code>)</li>
          </ul>

          <p>Create a logical vector:</p>

          <div class="org-src-container">
            <pre class="src src-R">
u <span class="org-constant">&lt;-</span> x &gt; <span class=
"org-string">"a"</span>
x[u]                                    <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">get all elements which are greater</span>
                                        <span class=
"org-comment-delimiter"># </span><span class="org-comment">than "a"</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-5" class="outline-3">
        <h3 id="sec-15-5"><span class="section-number-3">15.5</span> Selecting
        rows and columns more easily</h3>

        <div class="outline-text-3" id="text-15-5">
          <p>Subset on V1 and/or V2 &gt; 0.</p>

          <div class="org-src-container">
            <pre class="src src-R">
df[df$V1 &gt; 0 &amp; df$V2 &gt; 0, c(<span class=
"org-string">"V1"</span>, <span class="org-string">"V2"</span>)]
df[df$V1 &gt; 0 | df$V2 &gt; 0, c(<span class=
"org-string">"V1"</span>, <span class="org-string">"V2"</span>)]
</pre>
          </div>

          <p>Using the <code>subset</code> function.</p>

          <div class="org-src-container">
            <pre class="src src-R">
subset(df, select=c(V1, V2), subset=(V1 &gt; 0 &amp; V2 &gt; 0))
subset(df, select=c(V1, V2), subset=(V1 &gt; 0 | V2 &gt; 0))
</pre>
          </div>

          <p>Note that you <b>do <i>not</i> quote the column names</b> in the
          <code>subset</code> argument (and you <i>must</i> omit them in the
          <code>select</code> argument <i>if</i> the vector is negated).</p>

          <div class="warning">
            <p>This is a convenience function intended <b>for interactive
            use</b>. For programming, it is better to use the standard
            subsetting functions like <code>[</code>. In particular, the
            non-standard evaluation of argument <code>subset</code> can have
            unanticipated consequences.</p>
          </div>

          <p>Use the <code>%in%</code> operator to compare a variable to a list
          of desired values.</p>
        </div>
      </div>

      <div id="outline-container-sec-15-6" class="outline-3">
        <h3 id="sec-15-6"><span class="section-number-3">15.6</span> Removing
        NA from a list</h3>

        <div class="outline-text-3" id="text-15-6">
          <p>Remove missing values (<code>NA</code>) from a <b>list</b>:</p>

          <div class="org-src-container">
            <pre class="src src-R">
missing <span class=
"org-constant">&lt;-</span> is.na(x)                     <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">logical vector</span>
y <span class="org-constant">&lt;-</span> x[!missing]
sum(y)                                  <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">= sum(x, na.rm=TRUE)</span>
</pre>
          </div>

          <div class="note">
            <p>The function <code>sum</code> (like many other math functions in
            R) takes an argument <code>na.rm</code>. If you set
            <code>na.rm=TRUE</code>, R removes all NA values before doing the
            calculation.</p>
          </div>

          <p>The analogue of <code>is.na</code> for <b>data frames</b> is
          <code>complete.cases</code>.</p>
        </div>
      </div>

      <div id="outline-container-sec-15-7" class="outline-3">
        <h3 id="sec-15-7"><span class="section-number-3">15.7</span> Removing
        rows that contain NAs from a data frame</h3>

        <div class="outline-text-3" id="text-15-7">
          <p>Remove rows that contain any NA values:</p>

          <div class="org-src-container">
            <pre class="src src-R">
df <span class="org-constant">&lt;-</span> na.omit(df)
</pre>
          </div>

          <p>List all the rows of a data frame with <b>missing values</b>:</p>

          <div class="org-src-container">
            <pre class="src src-R">
nonmissing <span class="org-constant">&lt;-</span> complete.cases(df)
df[!nonmissing, ]
</pre>
          </div>

          <p>Take the subset of all objects (<code>dfx</code> and
          <code>dfy</code>) that has no missing values:</p>

          <div class="org-src-container">
            <pre class="src src-R">
bothnonmissing <span class=
"org-constant">&lt;-</span> complete.cases(dfx, dfy) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">logical vector</span>
dfx[bothnonmissing, ]
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-8" class="outline-3">
        <h3 id="sec-15-8"><span class="section-number-3">15.8</span> Removing
        columns that contain NAs from a data frame</h3>

        <div class="outline-text-3" id="text-15-8">
          <p>Get rid of any column that has one or more NAs.</p>

          <div class="org-src-container">
            <pre class="src src-R">
df <span class="org-constant">&lt;-</span> df[, colSums(is.na(df)) == 0]
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-9" class="outline-3">
        <h3 id="sec-15-9"><span class="section-number-3">15.9</span> Removing
        columns by name</h3>

        <div class="outline-text-3" id="text-15-9">
          <p>To <b>drop columns by name</b> in a data frame, you can use direct
          indexing (with booleans vectors) and then, simply reassign data:</p>

          <div class="org-src-container">
            <pre class="src src-R">
tokeep <span class="org-constant">&lt;-</span> !names(df) %<span class=
"org-keyword">in</span>% c(<span class=
"org-string">"remove1"</span>, <span class="org-string">"remove2"</span>)
df <span class=
"org-constant">&lt;-</span> df[, tokeep]                      <span class=
"org-comment-delimiter"># </span><span class="org-comment">or...</span>
df <span class="org-constant">&lt;-</span> df[, tokeep, drop=<span class=
"org-type">FALSE</span>]          <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">you will need this option to avoid the</span>
                                        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">conversion to an atomic vector if</span>
                                        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">there is only one column left</span>

df <span class=
"org-constant">&lt;-</span> subset(df, select=-c(remove1, remove2))
                                        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">use the `-' operator directly on a</span>
                                        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">vector of column names</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-10" class="outline-3">
        <h3 id="sec-15-10"><span class="section-number-3">15.10</span> Merging
        data frames by common column</h3>

        <div class="outline-text-3" id="text-15-10">
          <dl class="org-dl">
            <dt><code>merge(df1, df2, by="CustomerId")</code></dt>

            <dd>Natural join (special case of <b>inner</b> join).</dd>

            <dt><code>merge(df1, df2, by="CustomerId", all.x=TRUE)</code></dt>

            <dd><b>Left</b> (outer) join.</dd>

            <dt><code>merge(df1, df2, by="CustomerId", all.y=TRUE)</code></dt>

            <dd><b>Right</b> (outer) join.</dd>

            <dt><code>merge(df1, df2, by="CustomerId", all=TRUE)</code></dt>

            <dd><b>(Full) outer</b> join (all records from both tables).</dd>
          </dl>

          <p>Merge data sets (of different columns).</p>

          <div class="org-src-container">
            <pre class="src src-R">
merged.data <span class=
"org-constant">&lt;-</span> merge(df1, df2, by.x=<span class=
"org-string">"id1"</span>, by.y=<span class=
"org-string">"id2"</span>, all=<span class="org-type">TRUE</span>)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-11" class="outline-3">
        <h3 id="sec-15-11"><span class="section-number-3">15.11</span> Convert
        a list of data frames into one data frame</h3>

        <div class="outline-text-3" id="text-15-11">
          <p>Combine a list of data frames (of identical columns) into a single
          data frame:</p>

          <div class="org-src-container">
            <pre class="src src-R">
df <span class="org-constant">&lt;-</span> do.call(<span class=
"org-string">"rbind"</span>, list.of.data.frames)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-12" class="outline-3">
        <h3 id="sec-15-12"><span class="section-number-3">15.12</span>
        Converting</h3>

        <div class="outline-text-3" id="text-15-12">
          <dl class="org-dl">
            <dt><code>as.*()</code></dt>

            <dd>Explicitly coerce from one class to another.</dd>

            <dt><code>as.numeric()</code></dt>

            <dd>Coerce the (<code>character</code>) column to be
            <code>numeric</code>.</dd>

            <dt><code>as.Date("January 2, 2007", "%B %d, %Y")</code></dt>

            <dd>“2007-01-02”</dd>

            <dt><code>as.ts()</code></dt>

            <dd>Convert to a time series object.</dd>
          </dl>

          <p>You can always convert variables between types.</p>

          <div class="org-src-container">
            <pre class="src src-R">
df$x <span class=
"org-constant">&lt;-</span> as.factor(df$x)                 <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">character to factor</span>
df$x <span class=
"org-constant">&lt;-</span> as.character(df$x)              <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">factor to character</span>
</pre>
          </div>

          <div class="warning">
            <p><b>Warning</b><br />
            To convert factors to numeric or integer, first convert to
            character. Converting factors directly to numeric or integer data
            can lead to unwanted outcomes. Always check the results of a
            conversion to make sure R did what you wanted.</p>
          </div>

          <p>Convert at once all the string columns to factors:</p>

          <div class="org-src-container">
            <pre class="src src-R">
ind <span class="org-constant">&lt;-</span> sapply(x, is.character)
x[ind] <span class="org-constant">&lt;-</span> lapply(x[ind], factor)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-13" class="outline-3">
        <h3 id="sec-15-13"><span class="section-number-3">15.13</span> Applying
        a function to each list element</h3>

        <div class="outline-text-3" id="text-15-13">
          <p>Alternative (to <code>for</code> <b>loops</b>) to apply a function
          (or summary statistics).</p>

          <p>The following two articles provide the necessary background to
          motivate the <b>functional programming</b> techniques that are being
          provided by the <code>apply</code> family of functions.</p>

          <ul class="org-ul">
            <li><a href=
            "http://adv-r.had.co.nz/Functional-programming.html">Advanced R:
            Functional Programming</a>, by Hadley Wickham</li>

            <li><a href=
            "http://www.bioinformaticszen.com/post/simple-functional-programming-in-r/">
            Simple Functional Programming in R</a>, by Michael Barton</li>
          </ul>
        </div>

        <div id="outline-container-sec-15-13-1" class="outline-4">
          <h4 id="sec-15-13-1"><code>lapply</code></h4>

          <div class="outline-text-4" id="text-15-13-1">
            <p><b>Loop over a list</b> (or every <i>column</i> of a data frame)
            and apply a <b>function</b> on each <b>element. <i>Always</i>
            returns a list</b> back (that is, not a simplified result).</p>

            <ul class="org-ul">
              <li>(coerced) list <code>X</code></li>

              <li>function <code>FUN</code></li>

              <li>other arguments you wanna pass to the function
              <code>...</code></li>
            </ul>

            <div class="org-src-container">
              <pre class="src src-R">
x <span class="org-constant">&lt;-</span> list(a=1:5, b=rnorm(10))
lapply(x, mean)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-R">
lapply(1:4, runif, min=0, max=10)       <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">arguments passed through the `...'</span>
</pre>
            </div>

            <p>Extract the first column of each matrix of a list:</p>

            <div class="org-src-container">
              <pre class="src src-R">
lapply(x, <span class="org-keyword">function</span>(x) x[, 1])
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-15-13-2" class="outline-4">
          <h4 id="sec-15-13-2"><code>sapply</code></h4>

          <div class="outline-text-4" id="text-15-13-2">
            <p>Same as <code>lapply</code> (for lists or <i>columns</i> of data
            frames), but tries to “<b>simplify</b>” the <b>result</b> in a much
            more compact format (return the simplest possible data structure
            that can represent the output and is useful interactively, by
            putting all the elements into a <b>vector</b> or a <b>matrix</b>
            when possible, instead of returning a list).</p>

            <div class="org-src-container">
              <pre class="src src-R">
sapply(s, <span class=
"org-keyword">function</span>(x) colMeans(x[, c(<span class=
"org-string">"Ozone"</span>, <span class=
"org-string">"Solar.R"</span>, <span class="org-string">"Wind"</span>)]))
</pre>
            </div>

            <p>Pass <code>na.rm</code> argument to <code>ColMeans</code> to
            remove the missing values before calculating the mean.</p>

            <div class="org-src-container">
              <pre class="src src-R">
sapply(s, <span class=
"org-keyword">function</span>(x) colMeans(x[, c(<span class=
"org-string">"Ozone"</span>, <span class=
"org-string">"Solar.R"</span>, <span class=
"org-string">"Wind"</span>)], na.rm=<span class="org-type">TRUE</span>))
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-14" class="outline-3">
        <h3 id="sec-15-14"><span class="section-number-3">15.14</span>
        Splitting a vector into groups</h3>

        <div class="outline-text-3" id="text-15-14">
          <dl class="org-dl">
            <dt><code>split(x, f)</code></dt>

            <dd>
              Take a vector, and <b>split</b> it into subpieces (the number of
              groups identified by the levels of a <b>factor</b> variable).
              Always return a <b>list</b> (of lists?) back.

              <dl class="org-dl">
                <dt><code>drop = TRUE</code></dt>

                <dd>Don’t keep the empty levels of the factor.</dd>
              </dl>
            </dd>
          </dl>

          <p>Auxiliary function, used in conjunction with functions like
          <code>lapply</code> or <code>sapply</code> to apply a function to
          those individual groups.</p>

          <div class="org-src-container">
            <pre class="src src-R">
lapply(split(x, f), mean)
</pre>
          </div>

          <p>Like <code>tapply</code>, but without applying the summary
          statistics.</p>

          <p>Split a data frame (or other kinds of lists), and apply an
          <i>anonymous function</i>:</p>

          <div class="org-src-container">
            <pre class="src src-R">
s <span class=
"org-constant">&lt;-</span> split(airquality, airquality$Month) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">split according to month</span>
lapply(s, <span class=
"org-keyword">function</span>(x) colMeans(x[, c(<span class=
"org-string">"Ozone"</span>, <span class=
"org-string">"Solar.R"</span>, <span class="org-string">"Wind"</span>)])
</pre>
          </div>

          <p>Split a data frame into chunks of size <code>max</code>:</p>

          <div class="org-src-container">
            <pre class="src src-R">
size.max <span class="org-constant">&lt;-</span> 20
split(x, ceiling(seq_along(x$V1) / size.max))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-15" class="outline-3">
        <h3 id="sec-15-15"><span class="section-number-3">15.15</span> Applying
        a function to every row/column</h3>

        <div class="outline-text-3" id="text-15-15">
          <dl class="org-dl">
            <dt><code>apply(df, margin, fun, ...)</code></dt>

            <dd>
              <p>Apply a function over the <i>margins</i> of an
              <b>array</b>.</p>

              <p>Often used to apply a function to the rows or columns of a
              matrix. Very useful if you wanna take <b>summaries</b> of
              matrices or higher-dimensional arrays (such as array of
              matrices).</p>

              <p><code>MARGIN</code> is an integer vector which indicates which
              margins should be “retained”:</p>

              <ul class="org-ul">
                <li><b>margin 1</b> = apply FUN <b>for each row</b> (dimension
                1): preserve all the rows, eliminate all columns, get a vector
                of the number of rows</li>

                <li><b>margin 2</b> = <b>for each column</b> (dimension 2);
                first dimension has been eliminated</li>
              </ul>

              <div class="org-src-container">
                <pre class="src src-R">
x <span class="org-constant">&lt;-</span> matrix(rnorm(200), 20, 10)
apply(x, 2, mean)
</pre>
              </div>

              <div class="org-src-container">
                <pre class="src src-R">
x <span class="org-constant">&lt;-</span> matrix(rnorm(200), 20, 10)
apply(x, 1, quantile, probs=c(0.25, 0.75)) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">no default value for `probs'</span>
</pre>
              </div>

              <p>Shortcut functions (<i>much</i> faster on large matrices):</p>

              <ul class="org-ul">
                <li><code>rowSums</code> = <code>apply(x, 1, sum)</code></li>

                <li><code>rowMeans</code> = <code>apply(x, 1, mean)</code></li>

                <li><code>colSums</code> = <code>apply(x, 2, sum)</code></li>

                <li><code>colMeans</code> = <code>apply(x, 2, mean)</code></li>
              </ul>
            </dd>
          </dl>

          <div class="warning">
            <p><code>apply</code> works on matrices, <b>not data frames</b>. It
            will <b>coerce</b> the first argument <b>to a matrix</b>, by
            converting its columns to the lowest common form – which you can
            see with <code>apply(df, 2, class)</code>.</p>

            <p>If you are using a data frame which has character data as well
            as numeric data, <i>the whole matrix will be converted to
            character</i> and numerical operations will probably not give what
            you expect.</p>

            <p>Unlike <code>apply</code>, <code>sapply</code> does not coerce
            the data frame to a matrix: see <code>sapply(df, class)</code>.</p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-16" class="outline-3">
        <h3 id="sec-15-16"><span class="section-number-3">15.16</span> Applying
        a function to groups of data</h3>

        <div class="outline-text-3" id="text-15-16">
          <dl class="org-dl">
            <dt><code>tapply(x, index, fun)</code></dt>

            <dd>
              <p>Short for “<b>table apply</b>” (or “tagged apply”, where the
              tags identify the subsets).</p>

              <p>Apply a <b>function</b> over <b>subsets</b> of a vector:</p>

              <ul class="org-ul">
                <li>Splits up a vector into little groups (such as men and
                women, indicated by a <b>factor</b>),</li>

                <li>Applies a function to those groups and</li>

                <li>Brings the pieces back together.</li>
              </ul>

              <p>Function may be anonymous.</p>

              <p><code>Simplify = FALSE</code> to get back a list (instead of
              an array).</p>

              <p><code>tapply</code> is one of the most useful commands you’ll
              ever need. For example, to calculate statistics of <code>x</code>
              separately for each group identified in the variable
              <code>f</code>:</p>

              <div class="org-src-container">
                <pre class="src src-R">
tapply(x, f, sum, simplify=<span class="org-type">FALSE</span>)  <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">= lapply(split(x, f), sum)</span>
tapply(x, f, mean)                 <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">= sapply(split(x, f), mean)</span>
tapply(x, f, length)
</pre>
              </div>
            </dd>

            <dt><code>interaction(f1, f2)</code></dt>

            <dd>
              <p>Combines all the levels of the first factor with all the
              levels of the second factor.</p>

              <p>You can also use <code>aggregate</code> to analyze groups
              defined by more than one categorical variable (e.g., month and
              year).</p>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-15-17" class="outline-3">
        <h3 id="sec-15-17"><span class="section-number-3">15.17</span> Applying
        a function to parallel vectors or lists</h3>

        <div class="outline-text-3" id="text-15-17">
          <dl class="org-dl">
            <dt><code>mapply</code></dt>

            <dd>
              <p>Apply a <b>function</b> to the elements of <b>multiple
              lists</b> in parallel (multivariate version of
              <code>lapply</code>).</p>

              <p>For example, apply a function over 2 lists, where the elements
              of the first list go into one argument of the function, and the
              elements of the second list go into another argument of the
              function</p>

              <p><b>Vectorizing a function</b> (that doesn’t allow for vector
              arguments).</p>

              <div class="org-src-container">
                <pre class="src src-R">
mapply(rnorm, 1:3, 1:3, 2)         <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">fixed standard deviation</span>
</pre>
              </div>

              <p>is the same as</p>

              <div class="org-src-container">
                <pre class="src src-R">
list(rnorm(1, 1, 2),
     rnorm(2, 2, 2),
     rnorm(3, 3, 2))
</pre>
              </div>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-15-18" class="outline-3">
        <h3 id="sec-15-18"><span class="section-number-3">15.18</span> Checking
        on and removing inconsistent values</h3>
      </div>
    </div>

    <div id="outline-container-sec-16" class="outline-2">
      <h2 id="sec-16"><span class="section-number-2">16</span> 7. Strings and
      dates</h2>

      <div class="outline-text-2" id="text-16"></div>

      <div id="outline-container-sec-16-1" class="outline-3">
        <h3 id="sec-16-1"><span class="section-number-3">16.1</span> Getting
        the length of a string</h3>

        <div class="outline-text-3" id="text-16-1">
          <dl class="org-dl">
            <dt><code>nchar()</code></dt>

            <dd>Get the length of a string.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-16-2" class="outline-3">
        <h3 id="sec-16-2"><span class="section-number-3">16.2</span>
        Concatenating strings</h3>

        <div class="outline-text-3" id="text-16-2">
          <dl class="org-dl">
            <dt><code>paste()</code></dt>

            <dd>
              <p><b>Concatenate</b> a set of <b>strings together</b> to create
              one string or a vector of strings.</p>

              <p>Convert a vector to a string:</p>

              <div class="org-src-container">
                <pre class="src src-R">
paste(c(<span class="org-string">"This"</span>, <span class=
"org-string">"is"</span>, <span class="org-string">"one"</span>, <span class=
"org-string">"sentence."</span>), collapse=<span class="org-string">" "</span>)
</pre>
              </div>
              <pre class="example">
This is one sentence.
</pre>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-16-3" class="outline-3">
        <h3 id="sec-16-3"><span class="section-number-3">16.3</span> Regular
        expressions</h3>

        <div class="outline-text-3" id="text-16-3"></div>

        <div id="outline-container-sec-16-3-1" class="outline-4">
          <h4 id="sec-16-3-1">Metacharacters</h4>

          <div class="outline-text-4" id="text-16-3-1">
            <dl class="org-dl">
              <dt><code>^</code></dt>

              <dd>Start of a line (or negation of a character class).</dd>

              <dt><code>$</code></dt>

              <dd>End of a line.</dd>

              <dt><code>[]</code></dt>

              <dd>Character classes.</dd>

              <dt><code>.</code></dt>

              <dd>Any character.</dd>

              <dt><code>|</code></dt>

              <dd>Or.</dd>

              <dt><code>()</code></dt>

              <dd>Subexpressions (alternatives or “remember” matched
              text).</dd>

              <dt><code>?</code></dt>

              <dd>Optional.</dd>

              <dt>\</dt>

              <dd>“Escape” the metacharacter.</dd>

              <dt><code>+</code></dt>

              <dd>Any number, including none.</dd>

              <dt><code>*</code></dt>

              <dd>
                <p>Any number, at least one – it is “greedy” so it always
                matches the <i>longest</i> possible string that satisfies the
                regular expression.</p>

                <p>The greediness can be turned off with the <code>?</code>
                metacharacter (make the regex “lazy”), as in:</p>

                <div class="org-src-container">
                  <pre class="src src-R">
^s(.*?)s$
</pre>
                </div>
              </dd>

              <dt><code>{}</code></dt>

              <dd>Interval quantifiers (minimum, maximum).</dd>
            </dl>
          </div>
        </div>

        <div id="outline-container-sec-16-3-2" class="outline-4">
          <h4 id="sec-16-3-2">Regular expressions in R</h4>

          <div class="outline-text-4" id="text-16-3-2">
            <p>For the moment, we assume pattern matching on <b>ASCII
            strings</b>…</p>

            <p>These functions can take vector arguments.</p>

            <dl class="org-dl">
              <dt><code>grep</code></dt>

              <dd>
                <p>Return the <b>indices</b> into the character vector where
                the regex pattern matches (it won’t do anything).</p>

                <div class="org-src-container">
                  <pre class="src src-R">
i <span class="org-constant">&lt;-</span> grep(<span class=
"org-string">"regexp"</span>, vector)        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">get a set of indices</span>
j <span class="org-constant">&lt;-</span> grep(<span class=
"org-string">"anotherregexp"</span>, vector) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">get another set of indices</span>
setdiff(i, j)                      <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">substract j elements from i when they are the same</span>
setdiff(j, i)                      <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">different result</span>
</pre>
                </div>

                <p>Setting <code>value = TRUE</code> returns the <b>actual
                elements</b> of the character vector that match.</p>
              </dd>

              <dt><code>grepl</code></dt>

              <dd>Return a <b>logical vector</b> (<code>TRUE</code> /
              <code>FALSE</code>) indicating which element matches (used for
              <i>subsetting</i>).</dd>

              <dt><code>regexpr</code></dt>

              <dd>
                <p>Return the indices (integer vector) of the string <b>where
                the first match begins</b> and the length of the match.</p>

                <p>If I want to see what the match is, use
                <code>substr</code>:</p>

                <div class="org-src-container">
                  <pre class="src src-R">
regexpr(<span class="org-string">"..."</span>, string)
substr(string, start + length - 1)
</pre>
                </div>

                <p>Useful in conjunction with <code>regmatches</code> which
                extracts the matches in the strings without having you to use
                <code>substr</code>.</p>

                <div class="org-src-container">
                  <pre class="src src-R">
r <span class="org-constant">&lt;-</span> regexpr(<span class=
"org-string">"..."</span>, string)
regmatches(string, r)
</pre>
                </div>
              </dd>

              <dt><code>gregexpr</code></dt>

              <dd>Return <b>all of the matches</b> (“global”) in a given
              string.</dd>

              <dt><code>sub</code></dt>

              <dd>Replace <b>the first match</b> with another string (used to
              strip out stuff by replacing the match with nothing).</dd>

              <dt><code>gsub</code></dt>

              <dd>
                <p>Replace <b>all of the matches</b> with another string.</p>

                <div class="org-src-container">
                  <pre class="src src-R">
names(data)[i] <span class="org-constant">&lt;-</span> gsub(<span class=
"org-string">"-"</span>, <span class="org-string">"."</span>, names(data)[i])
</pre>
                </div>
              </dd>

              <dt><code>regexec</code></dt>

              <dd>
                <p>Give the indices (list) for parenthesized
                sub-expressions.</p>

                <p>If I want to see what the submatch is:</p>

                <div class="org-src-container">
                  <pre class="src src-R">
r <span class="org-constant">&lt;-</span> regexpr(<span class=
"org-string">"... (.*) ..."</span>, string) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">find all the date fields</span>
m <span class=
"org-constant">&lt;-</span> regmatches(string, r)         <span class=
"org-comment-delimiter"># </span><span class="org-comment">parse out</span>
dates <span class="org-constant">&lt;-</span> sapply(m, <span class=
"org-keyword">function</span>(x) x[2]) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">extract the 2nd element of each list object</span>
dates <span class="org-constant">&lt;-</span> as.Date(dates, <span class=
"org-string">"%B %d, %Y"</span>) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">convert to date</span>
hist(dates, <span class="org-string">"month"</span>, freq=<span class=
"org-type">TRUE</span>)    <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">aggregate the dates by month and give an histogram</span>
</pre>
                </div>
              </dd>
            </dl>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-17" class="outline-2">
      <h2 id="sec-17"><span class="section-number-2">17</span> 8.
      Probability</h2>

      <div class="outline-text-2" id="text-17"></div>

      <div id="outline-container-sec-17-1" class="outline-3">
        <h3 id="sec-17-1"><span class="section-number-3">17.1</span> Names of
        distributions</h3>

        <div class="outline-text-3" id="text-17-1">
          <ul class="org-ul">
            <li>Functions for <b>probability distributions</b>

              <dl class="org-dl">
                <dt>rnorm(n, mean, sd)</dt>

                <dd>Generate <code>n</code> <b>normal</b> random variates</dd>

                <dt>runif(n)</dt>

                <dd>Generate <code>n</code> <b>uniform</b> random variates</dd>

                <dt>rpois(n, lambda)</dt>

                <dd>Generate <code>n</code> <b>Poisson</b> random variates with
                a given rate</dd>

                <dt>rbinom(n, size, prob)</dt>

                <dd>Generate binary data</dd>

                <dt>rexp</dt>
              </dl>
            </li>
          </ul>

          <dl class="org-dl">
            <dt>rgamma</dt>
          </dl>

          <ul class="org-ul">
            <li>Associated functions

              <dl class="org-dl">
                <dt>r*</dt>

                <dd>Generate <b>random</b> numbers (draw samples)</dd>

                <dt>d*</dt>

                <dd>Evaluate the probability <b>density</b></dd>

                <dt>p*</dt>

                <dd>
                  <p>Evaluate the <b>cumulative distribution</b> function</p>

                  <div class="org-src-container">
                    <pre class="src src-R">
ppois(4, 2)                      <span class=
"org-comment-delimiter"># </span><span class="org-comment">Pr(x &lt;= 4)</span>
ppois(6, 2)                      <span class=
"org-comment-delimiter"># </span><span class="org-comment">Pr(x &lt;= 6)</span>
</pre>
                  </div>
                </dd>

                <dt>q*</dt>

                <dd>evaluate the <b>quantile</b> function</dd>
              </dl>
            </li>
          </ul>
        </div>
      </div>

      <div id="outline-container-sec-17-2" class="outline-3">
        <h3 id="sec-17-2"><span class="section-number-3">17.2</span> Generate
        reproducible random numbers</h3>

        <div class="outline-text-3" id="text-17-2">
          <p>Set the random number <b>seed</b> is critical for
          <b>reproducibility</b>: <b>always set it when conducting a
          simulation!</b></p>

          <div class="org-src-container">
            <pre class="src src-R">
set.seed(1)                           <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">or use any other positive integer</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-17-3" class="outline-3">
        <h3 id="sec-17-3"><span class="section-number-3">17.3</span> Generate a
        random sample</h3>

        <div class="outline-text-3" id="text-17-3">
          <p><b>Sample randomly</b> from a specified vector of scalar
          objects.</p>

          <div class="org-src-container">
            <pre class="src src-R">
sample(1:10, 4)                         <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">select 4 different numbers at random</span>
sample(1:10)                            <span class=
"org-comment-delimiter"># </span><span class="org-comment">permutation</span>
sample(1:10, replace = <span class=
"org-type">TRUE</span>)            <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">sample with replacement (I can get repeats)</span>
</pre>
          </div>

          <p>Sample can draw according to a set of probabilities.</p>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-18" class="outline-2">
      <h2 id="sec-18"><span class="section-number-2">18</span> 10.
      Graphics</h2>

      <div class="outline-text-2" id="text-18">
        <p>2 systems:</p>

        <dl class="org-dl">
          <dt><code>base</code></dt>

          <dd>
            Graphics are constructed piecemeal by <b>different function
            calls</b>; you can add things one by one:

            <ul class="org-ul">
              <li>annotate (some of the points in) the plot,</li>

              <li>put some points on the canvas,</li>

              <li>draw a title,</li>

              <li>add some axis labels,</li>

              <li>add some colors,</li>

              <li>add a legend.</li>
            </ul>
          </dd>

          <dt><code>lattice</code></dt>

          <dd>Graphics are constructed via a single function call: all options
          have to be specified at once (advantage: that allows R to calculate
          the necessary spacings, margins and font sizes).</dd>
        </dl>

        <p>Behavior:</p>

        <ul class="org-ul">
          <li>Base graphics functions have a “side effect”: they plot data
          directly to the graphics device.</li>

          <li>
            <p>Lattice graphics functions return an object of the class
            <code>trellis</code> (object designed for plotting).</p>

            <p>When you call Lattice functions, even if you don’t assign it to
            a “plot object”, the result will be <b>auto-printed</b> (generate
            the plot <b>on the graphics device</b>), so it will look like
            Lattice functions have a “side effect”</p>
          </li>
        </ul>

        <p>You cannot use functions from the base plotting system in a Lattice
        plot.</p>
      </div>

      <div id="outline-container-sec-18-1" class="outline-3">
        <h3 id="sec-18-1"><span class="section-number-3">18.1</span> Base
        graphics</h3>

        <div class="outline-text-3" id="text-18-1"></div>

        <div id="outline-container-sec-18-1-1" class="outline-4">
          <h4 id="sec-18-1-1">Make a plot</h4>

          <div class="outline-text-4" id="text-18-1-1">
            <dl class="org-dl">
              <dt><code>plot</code></dt>

              <dd>Create a <b>scatter plot</b> (or another type of plot,
              depending on the class of the object being plotted).</dd>

              <dt><code>barplot</code></dt>

              <dd>Create a <b>bar chart</b> (analogue of an histogram for
              categorical data).</dd>

              <dt><code>hist</code></dt>

              <dd>Make an <b>histogram</b> showing the <b>distribution</b> of
              the numeric vector <code>x</code>.</dd>

              <dt><code>boxplot</code></dt>

              <dd>Create a box-and-whisker plot of the <code>y</code> variable
              by the grouping variable <code>x</code> (usually a
              <code>factor</code>).</dd>
            </dl>
          </div>

          <div id="outline-container-sec-18-1-1-1" class="outline-5">
            <h5 id="sec-18-1-1-1">Create a scatter plot</h5>

            <div class="outline-text-5" id="text-18-1-1-1">
              <dl class="org-dl">
                <dt><code>plot(x)</code></dt>

                <dd>
                  <p>Plot the (numeric) data against the index
                  (<code>1:N</code>).</p>

                  <div class="org-src-container">
                    <pre class="src src-R">
data(iris)
plot(sort(iris$Petal.Width),
     main=<span class="org-string">"Distribution of petal widths"</span>,
     xlab=<span class="org-string">"Rank"</span>, ylab=<span class=
"org-string">"Width"</span>, col=as.integer(iris$Species)+1)
</pre>
                  </div>

                  <div class="figure">
                    <p><img src="Rplots/base-scatterplot-sort.png" alt=
                    "base-scatterplot-sort.png" /></p>
                  </div>
                </dd>

                <dt><code>plot(x, y)</code></dt>

                <dd>
                  <p>Create a scatter plot of <code>x</code> and
                  <code>y</code>.</p>

                  <div class="org-src-container">
                    <pre class="src src-R">
data(iris)
plot(iris$Petal.Length, iris$Petal.Width,
     main=<span class="org-string">"Petals: Length vs Width"</span>,
     xlab=<span class="org-string">"Length"</span>, ylab=<span class=
"org-string">"Width"</span>, col=as.integer(iris$Species)+1)
</pre>
                  </div>

                  <div class="figure">
                    <p><img src="Rplots/base-scatterplot.png" alt=
                    "base-scatterplot.png" /></p>
                  </div>
                </dd>

                <dt><code>plot(x, y, type = "n")</code></dt>

                <dd>
                  <p>Set up the plot window, but don’t actually plot the data
                  in there.</p>

                  <p>Note that you have <code>POSIXct</code> dates in your data
                  frame… XXX</p>
                </dd>

                <dt><code>plot(df)</code></dt>

                <dd>
                  <p>Create <b>multiple scatter plots</b> if your data frame
                  contains more than 2&nbsp;columns.</p>

                  <div class="org-src-container">
                    <pre class="src src-R">
data(iris)
plot(iris[, 1:4], main=<span class=
"org-string">"Multiple scatter plots"</span>,
     col=as.integer(iris$Species)+1)
</pre>
                  </div>

                  <div class="figure">
                    <p><img src="Rplots/base-multi-scatterplots.png" alt=
                    "base-multi-scatterplots.png" /></p>
                  </div>

                  <p>You can see that petal length and width appear strongly
                  correlated. You could check the correlation between features
                  with the <code>cor()</code> function.</p>

                  <div class="org-src-container">
                    <pre class="src src-R">
data(iris)
cor(iris[-5])
</pre>
                  </div>

                  <table border="2" cellspacing="0" cellpadding="6" rules=
                  "groups" frame="hsides">
                    <colgroup>
                      <col class="right" />
                      <col class="right" />
                      <col class="right" />
                      <col class="right" />
                    </colgroup>

                    <tbody>
                      <tr>
                        <td class="right">1</td>

                        <td class="right">-0.117569784133002</td>

                        <td class="right">0.871753775886583</td>

                        <td class="right">0.817941126271576</td>
                      </tr>

                      <tr>
                        <td class="right">-0.117569784133002</td>

                        <td class="right">1</td>

                        <td class="right">-0.42844010433054</td>

                        <td class="right">-0.366125932536439</td>
                      </tr>

                      <tr>
                        <td class="right">0.871753775886583</td>

                        <td class="right">-0.42844010433054</td>

                        <td class="right">1</td>

                        <td class="right">0.962865431402796</td>
                      </tr>

                      <tr>
                        <td class="right">0.817941126271576</td>

                        <td class="right">-0.366125932536439</td>

                        <td class="right">0.962865431402796</td>

                        <td class="right">1</td>
                      </tr>
                    </tbody>
                  </table>
                </dd>
              </dl>
            </div>
          </div>

          <div id="outline-container-sec-18-1-1-2" class="outline-5">
            <h5 id="sec-18-1-1-2"><span class="todo TODO">TODO</span>
            <code>barplot</code></h5>

            <div class="outline-text-5" id="text-18-1-1-2">
              <p>See <a href=
              "http://onertipaday.blogspot.be/2007/05/barplots-of-two-sets.html">
              http://onertipaday.blogspot.be/2007/05/barplots-of-two-sets.html</a>
              for barplot with figures above the bars.</p>
            </div>
          </div>

          <div id="outline-container-sec-18-1-1-3" class="outline-5">
            <h5 id="sec-18-1-1-3"><code>hist</code></h5>

            <div class="outline-text-5" id="text-18-1-1-3">
              <p>Histogram (<b>distribution</b> of data, <b>frequency</b> =
              exact number).</p>

              <p>Generic function: you can call it on different types of data.
              When you call <code>hist</code> on a <code>Date</code> object, it
              requires an interval (“day” / “week” / “month” / “year”) in order
              to break it up into sequences.</p>

              <div class="org-src-container">
                <pre class="src src-R">
data(iris)
hist(iris$Petal.Length, main=<span class=
"org-string">"Histogram"</span>, col=<span class=
"org-string">"lightblue"</span>) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">shape of distribution</span>
</pre>
              </div>

              <div class="figure">
                <p><img src="Rplots/base-hist.png" alt="base-hist.png" /></p>
              </div>

              <p><code>breaks</code> is key: it specifies the number of
              categories to plot or the breakpoints for each category.</p>

              <div class="org-src-container">
                <pre class="src src-R">
data(iris)
hist(iris$Petal.Length, breaks=seq(1, 7, by=0.1), main=<span class=
"org-string">"Histogram"</span>, col=<span class=
"org-string">"lightblue"</span>)
                                        <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">much more fine-grained distribution</span>
</pre>
              </div>

              <div class="figure">
                <p><img src="Rplots/base-hist-breaks.png" alt=
                "base-hist-breaks.png" /></p>
              </div>

              <p>Can you explain the peculiar pattern? Graphical
              representations of data are useful at identifying these sorts of
              artifacts…</p>

              <p>Report where the distribution is centered:</p>

              <div class="org-src-container">
                <pre class="src src-R">
data(iris)
hist(iris$Petal.Length, breaks=100, main=<span class=
"org-string">"Histogram"</span>, col=<span class=
"org-string">"lightblue"</span>)
meanValue <span class="org-constant">&lt;-</span> mean(iris$Petal.Length)
lines(rep(meanValue, 100), seq(0, 100, length=100), col=<span class=
"org-string">"red"</span>, lwd=5)
</pre>
              </div>

              <div class="figure">
                <p><img src="Rplots/base-hist-center.png" alt=
                "base-hist-center.png" /></p>
              </div>

              <div class="org-src-container">
                <pre class="src src-R">
data(iris)
plot(table(iris$Petal.Length), main=<span class=
"org-string">"Table"</span>, col=<span class="org-string">"blue"</span>)
</pre>
              </div>

              <div class="figure">
                <p><img src="Rplots/base-plot-table.png" alt=
                "base-plot-table.png" /></p>
              </div>

              <p>Note – In the table plot, x values with one occurrence (out of
              thousands) would be visible as one dot in the graphics. They
              don’t in the histogram (as the line, being too small, would be on
              the x-axis itself).</p>

              <ul class="org-ul">
                <li>
                  <p>Density plot (smoother histogram)</p>

                  <p><b>Density</b> = percentage of observations</p>

                  <div class="org-src-container">
                    <pre class="src src-R">
  dens <span class="org-constant">&lt;-</span> density(data$var) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">smooth density function</span>
  plot(dens, lwd=3, col=<span class="org-string">"blue"</span>)
<span class="org-comment-delimiter"># </span><span class=
"org-comment">or: lines(dens, lwd=3, col="blue") after hist plot</span>
</pre>
                  </div>

                  <p>Easy to compare multiple distributions:</p>

                  <div class="org-src-container">
                    <pre class="src src-R">
<span class="org-comment-delimiter"># </span><span class=
"org-comment">add another density</span>
densMales <span class=
"org-constant">&lt;-</span> density(data$var[which(data$sex==1)])
lines(densMales, lwd=3, col=<span class="org-string">"orange"</span>)
</pre>
                  </div>
                </li>
              </ul>
            </div>
          </div>

          <div id="outline-container-sec-18-1-1-4" class="outline-5">
            <h5 id="sec-18-1-1-4"><code>boxplot</code></h5>

            <div class="outline-text-5" id="text-18-1-1-4">
              <p><code>boxplot</code> draws plot summarizing:</p>

              <ul class="org-ul">
                <li>Median (wide line)</li>

                <li>Quartiles (Q1, Q3)</li>

                <li>Lowest data still within 1.5 * IQR (= Q3 - Q1) of the lower
                quartile, and the highest datum still within 1.5 * IQR of the
                upper quartile</li>

                <li>Outliers — By default, observations more than 1.5 * IQR
                distant from nearest quartile</li>
              </ul>

              <div class="org-src-container">
                <pre class="src src-R">
data(iris)
boxplot(iris[, 1:4], col=rainbow(4), main=<span class=
"org-string">"Boxplot"</span>, ylab=<span class=
"org-string">"Appropriate units"</span>)
</pre>
              </div>

              <div class="figure">
                <p><img src="Rplots/base-boxplot.png" alt=
                "base-boxplot.png" /></p>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-18-1-1-5" class="outline-5">
            <h5 id="sec-18-1-1-5">violinplot</h5>

            <div class="outline-text-5" id="text-18-1-1-5">
              <p>See <a href=
              "http://www.math.csi.cuny.edu/Statistics/R/simpleR/stat006.html">http://www.math.csi.cuny.edu/Statistics/R/simpleR/stat006.html</a></p>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-18-1-2" class="outline-4">
          <h4 id="sec-18-1-2">Add to an existing plot</h4>

          <div class="outline-text-4" id="text-18-1-2">
            <dl class="org-dl">
              <dt><code>points</code></dt>

              <dd>
                <p><b>Add points to a plot</b> (<code>col</code> for boundary
                color, <code>bg</code> for fill color, <code>pch</code> for
                plotting character).</p>

                <p>Plot points <b>in groups separately</b>.</p>

                <div class="org-src-container">
                  <pre class="src src-R">
data(iris)
<span class="org-constant">attach</span>(iris)
plot(Petal.Length, Petal.Width, type=<span class="org-string">"n"</span>)
points(Petal.Length[Species == <span class=
"org-string">"setosa"</span>], Petal.Width[Species == <span class=
"org-string">"setosa"</span>],
       col=<span class="org-string">"red"</span>)
points(Petal.Length[Species == <span class=
"org-string">"versicolor"</span>], Petal.Width[Species == <span class=
"org-string">"versicolor"</span>],
       col=<span class="org-string">"green"</span>, pch=19)
points(Petal.Length[Species == <span class=
"org-string">"virginica"</span>], Petal.Width[Species == <span class=
"org-string">"virginica"</span>],
       col=<span class="org-string">"blue"</span>, pch=18)
</pre>
                </div>

                <div class="figure">
                  <p><img src="Rplots/base-points-distinguished.png" alt=
                  "base-points-distinguished.png" /></p>
                </div>

                <div class="org-src-container">
                  <pre class="src src-R">
data(iris)
plot(iris$Petal.Length, iris$Petal.Width, col=as.integer(iris$Species)+1)
</pre>
                </div>

                <div class="figure">
                  <p><img src="Rplots/base-points-distinguished-col.png" alt=
                  "base-points-distinguished-col.png" /></p>
                </div>

                <div class="org-src-container">
                  <pre class="src src-R">
data(iris)
plot(iris[, 3:4], col=c(<span class="org-string">"red"</span>, <span class=
"org-string">"green"</span>, <span class=
"org-string">"blue"</span>)[unclass(iris$Species)])
</pre>
                </div>

                <div class="figure">
                  <p><img src=
                  "Rplots/base-points-distinguished-col-unclass.png" alt=
                  "base-points-distinguished-col-unclass.png" /></p>
                </div>
              </dd>

              <dt><code>lines</code></dt>

              <dd>
                <p><b>Add lines</b> (connect all the dots) <b>to a
                plot</b>.</p>

                <div class="org-src-container">
                  <pre class="src src-R">
lines(x, y)                        <span class=
"org-comment-delimiter"># </span><span class="org-comment">all lines</span>
</pre>
                </div>

                <p>Even better: option <code>type="b"</code> to plot method for
                <i>both</i> <b>points and lines</b>.</p>
              </dd>

              <dt><code>abline</code></dt>

              <dd>
                <p>Add a straight line.</p>

                <p>Plot the <b>regression line</b> of a scatter plot.</p>

                <div class="org-src-container">
                  <pre class="src src-R">
data(iris)
<span class="org-constant">attach</span>(iris)
plot(Petal.Length, Petal.Width)
fit <span class="org-constant">&lt;-</span> lm(Petal.Width ~ Petal.Length)
abline(fit, lwd=3, col=<span class="org-string">"blue"</span>)
</pre>
                </div>

                <div class="figure">
                  <p><img src="Rplots/base-abline.png" alt=
                  "base-abline.png" /></p>
                </div>
              </dd>
            </dl>

            <dl class="org-dl">
              <dt><code>text</code></dt>

              <dd>
                <p>Add text labels (inside the plot region).</p>

                <p>Could be used to label datapoints.</p>

                <div class="org-src-container">
                  <pre class="src src-R">
text(-2, 2, <span class="org-string">"Label"</span>)
</pre>
                </div>
              </dd>

              <dt><code>title</code></dt>

              <dd>
                <p>Add a title (or axis labels, subtitle, …).</p>

                <div class="org-src-container">
                  <pre class="src src-R">
title(<span class="org-string">"plot"</span>)
plot(x, y, xlab=<span class="org-string">"Weight"</span>, ylab=<span class=
"org-string">"Height"</span>, main=<span class=
"org-string">"Scatterplot"</span>)
</pre>
                </div>
              </dd>

              <dt><code>mtext</code></dt>

              <dd>
                <p>Add <b>text to the margins</b>.</p>

                <div class="org-src-container">
                  <pre class="src src-R">
mtext(<span class=
"org-string">"Label on the X-axis"</span>, side=2, line=3, col=<span class=
"org-string">"blue"</span>)
</pre>
                </div>

                <p>Can be used to add multiline legends.</p>
              </dd>

              <dt><code>axis</code></dt>

              <dd>
                <p><b>Annotate the axis</b> (tick marks, labels).</p>

                <div class="org-src-container">
                  <pre class="src src-R">
axis(side=2, col=<span class="org-string">"blue"</span>, col.axis=<span class=
"org-string">"blue"</span>, las=1)
</pre>
                </div>
              </dd>

              <dt><code>legend</code></dt>

              <dd>
                <p>Add a legend.</p>

                <div class="org-src-container">
                  <pre class="src src-R">
legend(<span class="org-string">"topleft"</span>, legend=<span class=
"org-string">"Data"</span>, pch=1)
</pre>
                </div>
              </dd>
            </dl>
          </div>
        </div>

        <div id="outline-container-sec-18-1-3" class="outline-4">
          <h4 id="sec-18-1-3">Changing graphical parameters</h4>

          <div class="outline-text-4" id="text-18-1-3">
            <dl class="org-dl">
              <dt><code>par()</code></dt>

              <dd>
                <p>control <b>all the graphing parameters</b> that you can
                specify (<i>defaults</i> for all plots in a session, which can
                be overridden as arguments to specific plotting functions).</p>

                <dl class="org-dl">
                  <dt><code>pch</code></dt>

                  <dd><b>Plotting character</b> (default: open circle
                  symbol).</dd>

                  <dt><code>lty</code></dt>

                  <dd>Line type (default: <code>solid</code> line).</dd>

                  <dt><code>lwd</code></dt>

                  <dd>Line width.</dd>

                  <dt><code>col</code></dt>

                  <dd>Plotting color.</dd>

                  <dt><code>las</code></dt>

                  <dd>Orientation of the axis labels on the plot
                  (<code>las=2</code> will set the tick <b>labels</b> to be
                  <b>perpendicular</b> to the axis).</dd>

                  <dt><code>bg</code></dt>

                  <dd>Background color (default:
                  <code>transparent</code>).</dd>

                  <dt><code>mar</code></dt>

                  <dd>
                    <p>Margin size (vector of 4 numbers, 1 per side).</p>

                    <div class="org-src-container">
                      <pre class="src src-R">
par(mar=c(2, 2, 1, 1))
</pre>
                    </div>
                  </dd>

                  <dt><code>oma</code></dt>

                  <dd>Outer margin size (relevant if you have more than one
                  plot per canvas).</dd>

                  <dt><code>mfrow</code></dt>

                  <dd>
                    <p>Number of <b>plots per row and per column</b> on the
                    canvas (filled row-wise).</p>

                    <div class="org-src-container">
                      <pre class="src src-R">
par(mfrow=c(2, 1))            <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">2 rows and 1 column</span>
plot(x, y)
plot(x, z)
</pre>
                    </div>
                  </dd>

                  <dt><code>mfcol</code></dt>

                  <dd>Number of plots per row and per column on the canvas
                  (filled column-wise).</dd>

                  <dt><code>bty</code></dt>

                  <dd>
                    <p>Type of “box” which is drawn around plots.</p>

                    <p>A value of <code>"n"</code> suppresses the box (same as
                    <code>axes=FALSE</code>).</p>
                  </dd>
                </dl>

                <p>Look at the defaults:</p>

                <div class="org-src-container">
                  <pre class="src src-R">
par(<span class="org-string">"lty"</span>)
</pre>
                </div>
              </dd>

              <dt><code>?Devices</code></dt>

              <dd>
                List graphical devices.

                <dl class="org-dl">
                  <dt><code>pdf</code></dt>

                  <dd>Vector format (very, very large for a graphic with <b>2
                  million points</b> on it: specify information for every
                  single object on the plot).</dd>

                  <dt><code>png</code></dt>

                  <dd>Bitmapped format (specify information for pixels),
                  lossless <b>compression</b>, but <b>does not resize
                  well</b>.</dd>

                  <dt><code>jpeg</code></dt>

                  <dd>Lossy compression.</dd>

                  <dt><code>bitmap</code></dt>

                  <dd>If you’re running R in a batch mode (you can’t use the
                  <code>png</code> and <code>jpeg</code> functions).</dd>
                </dl>
              </dd>

              <dt>(no term)</dt>

              <dd>
                Copy the plot to another device

                <dl class="org-dl">
                  <dt><code>dev.copy2pdf</code></dt>

                  <dd>copy a plot to PDF</dd>
                </dl>
              </dd>
            </dl>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-18-2" class="outline-3">
        <h3 id="sec-18-2"><span class="section-number-3">18.2</span> Lattice
        graphics</h3>

        <div class="outline-text-3" id="text-18-2">
          <ul class="org-ul">
            <li>
              <p>Tellis graphics</p>

              <dl class="org-dl">
                <dt><code>xyplot</code></dt>

                <dd><b>scatterplots</b></dd>

                <dt><code>bwplot</code></dt>

                <dd>box-and-whiskers plots (“boxplots”)</dd>

                <dt>histogram</dt>

                <dd>histograms</dd>

                <dt>stripplot</dt>

                <dd>like a boxplot but with actual points (instead of
                boxes)</dd>

                <dt>dotplot</dt>

                <dd>plot dots on “violin strings”</dd>

                <dt>splom</dt>

                <dd>scatterplot matrix, like <code>pairs</code> in the base
                graphics system</dd>

                <dt><code>levelplot</code>, <code>contourplot</code></dt>

                <dd>for plotting “image” data</dd>
              </dl>

              <div class="org-src-container">
                <pre class="src src-R">
<span class="org-constant">library</span>(lattice)
</pre>
              </div>

              <table border="2" cellspacing="0" cellpadding="6" rules="groups"
              frame="hsides">
                <colgroup>
                  <col class="left" />
                </colgroup>

                <tbody>
                  <tr>
                    <td class="left">lattice</td>
                  </tr>

                  <tr>
                    <td class="left">stats</td>
                  </tr>

                  <tr>
                    <td class="left">graphics</td>
                  </tr>

                  <tr>
                    <td class="left">grDevices</td>
                  </tr>

                  <tr>
                    <td class="left">utils</td>
                  </tr>

                  <tr>
                    <td class="left">datasets</td>
                  </tr>

                  <tr>
                    <td class="left">methods</td>
                  </tr>

                  <tr>
                    <td class="left">base</td>
                  </tr>
                </tbody>
              </table>
            </li>

            <li>Generally create plots all in one go, from a single function
            call</li>

            <li>
              <p>Strength of Lattice functions = conditioning plots: you can
              plot the <b>relationship</b> between <code>x</code> and
              <code>y</code>, <b>conditioned</b> on the levels of a third
              variable (factor variable <code>f</code> or variable cut into
              different ranges, see <code>equal.count</code>)</p>

              <div class="org-src-container">
                <pre class="src src-R">
y ~ x | f * g                         <span class=
"org-comment-delimiter"># </span><span class="org-comment">formula</span>
</pre>
              </div>

              <ul class="org-ul">
                <li><code>y</code> = response (on the y-axis)</li>

                <li><code>x</code> = input, predictor (on the x-axis)</li>

                <li><code>f * g</code> = factors which are <b>interacting</b>
                with each other (often, just one factor)</li>
              </ul>
            </li>

            <li>
              <p>Tell the function <code>xyplot</code> where to find the
              variables <code>y</code> and <code>x</code>: look up names inside
              the <code>environmental</code> data frame (because they are not
              objects in my workspace)</p>

              <div class="org-src-container">
                <pre class="src src-R">
xyplot(y ~ x, data = environmental)
</pre>
              </div>
            </li>

            <li>
              <p>Lattice functions have a separate panel created for each level
              of the factors</p>

              <div class="org-src-container">
                <pre class="src src-R">
xyplot(y ~ x | f)
</pre>
              </div>

              <p>The <b>panel function</b> controls what happens inside each
              panel of the entire plot</p>

              <p>I can create my own (anonymous) panel function:</p>

              <div class="org-src-container">
                <pre class="src src-R">
xyplot(y ~ x | f,
       panel = <span class=
"org-keyword">function</span>(x, y, ...) {  <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">x and y = data that appear in a specific panel (it's not all the data)</span>
               panel.xyplot(x, y, ...) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">plot using all the default options</span>
               panel.abline(h = median(y), lty = 2) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">plot the median of the y values in each panel</span>
       })
</pre>
              </div>

              <p>Add a (simple linear) regression line to each panel of the
              plot:</p>

              <div class="org-src-container">
                <pre class="src src-R">
xyplot(y ~ x | f,
       panel = <span class="org-keyword">function</span>(x, y, ...) {
               panel.xyplot(x, y, ...)
               panel.lmline(x, y, col = 2)
       })
</pre>
              </div>

              <div class="org-src-container">
                <pre class="src src-R">
xyplot(y ~ x | f, pch = 20,
       panel = <span class="org-keyword">function</span>(x, y, ...) {
               panel.xyplot(x, y, ...)
               fit <span class="org-constant">&lt;-</span> lm(y ~ x)
               panel.abline(fit, lwd = 2) <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">add a regression line to the plot</span>
       })
</pre>
              </div>
            </li>

            <li>Options

              <ul class="org-ul">
                <li>Don’t worry about spacing: everything gets automatically
                adjusted!</li>

                <li id="main">title</li>

                <li id="layout = c(1,4)">4 panels on top of each other</li>

                <li id="as.table = TRUE">change the order in which the panels
                are drawn, from top to bottom (default: from bottom to
                top)</li>

                <li id="xlab">label on the x-axis</li>

                <li id="ylab">label on the y-axis</li>
              </ul>
            </li>

            <li>Functions

              <dl class="org-dl">
                <dt>x.cut &lt;- equal.count(x, l)</dt>

                <dd>cut the original <code>x</code> variable, creating
                <code>l</code> different ranges (~ levels, which may overlap
                slightly)</dd>

                <dt>panel.loess(x, y)</dt>

                <dd>give a smooth rendition of the linear model</dd>
              </dl>
            </li>
          </ul>
        </div>

        <div id="outline-container-sec-18-2-1" class="outline-4">
          <h4 id="sec-18-2-1">Splom</h4>

          <div class="outline-text-4" id="text-18-2-1">
            <ul class="org-ul">
              <li>
                <p>Look at pairwise relationships possible in the data frame
                (make a scatter plot of all the different variables against
                each other)</p>

                <div class="org-src-container">
                  <pre class="src src-R">
splom(~ df)
</pre>
                </div>
              </li>
            </ul>
          </div>
        </div>

        <div id="outline-container-sec-18-2-2" class="outline-4">
          <h4 id="sec-18-2-2">Histogram</h4>

          <div class="outline-text-4" id="text-18-2-2">
            <ul class="org-ul">
              <li>
                <p>Histogram of <code>x</code></p>

                <div class="org-src-container">
                  <pre class="src src-R">
histogram(~ x, data = df)
</pre>
                </div>
              </li>

              <li>
                <p>Histogram of <code>x</code>, as <code>f</code> varies (for
                each range of <code>f.cut</code>)</p>

                <div class="org-src-container">
                  <pre class="src src-R">
histogram(~ x | f.cut, data = df)
</pre>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-18-3" class="outline-3">
        <h3 id="sec-18-3"><span class="section-number-3">18.3</span>
        ggplot2</h3>

        <div class="outline-text-3" id="text-18-3">
          <p>See <a href=
          "http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html">http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html</a>
          for a comparison with Base graphics.</p>

          <p>See post of Antoine Lizée in <a href=
          "http://stackoverflow.com/questions/5234117/how-to-drop-columns-by-name-in-a-data-frame">
          http://stackoverflow.com/questions/5234117/how-to-drop-columns-by-name-in-a-data-frame</a>
          for an excellent performance reporting.</p>

          <div class="org-src-container">
            <pre class="src src-R">
<span class="org-constant">library</span>(ggplot2)
summary(cars)
qplot(speed, dist, data=cars) + geom_smooth()
</pre>
          </div>

          <div class="figure">
            <p><img src="Rplots/ggplot2.png" alt="ggplot2.png" /></p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-18-4" class="outline-3">
        <h3 id="sec-18-4"><span class="section-number-3">18.4</span> Other
        graphics</h3>

        <div class="outline-text-3" id="text-18-4"></div>

        <div id="outline-container-sec-18-4-1" class="outline-4">
          <h4 id="sec-18-4-1">Pareto diagrams</h4>

          <div class="outline-text-4" id="text-18-4-1">
            <div class="org-src-container">
              <pre class="src src-R">
<span class="org-comment-delimiter">## </span><span class=
"org-comment">install.packages("qcc")</span>
<span class="org-constant">library</span>(qcc)
data(iris)
pareto.chart(table(iris[iris$Species==<span class=
"org-string">"setosa"</span>, ]$Petal.Length))
</pre>
            </div>

            <div class="figure">
              <p><img src="Rplots/qcc-pareto.png" alt="qcc-pareto.png" /></p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-19" class="outline-2">
      <h2 id="sec-19"><span class="section-number-2">19</span> 11. Linear
      regression and ANOVA</h2>

      <div class="outline-text-2" id="text-19">
        <p><a href=
        "https://www.zoology.ubc.ca/~schluter/R/fit-model/">https://www.zoology.ubc.ca/~schluter/R/fit-model/</a></p>
      </div>

      <div id="outline-container-sec-19-1" class="outline-3">
        <h3 id="sec-19-1"><span class="section-number-3">19.1</span> Linear
        model</h3>

        <div class="outline-text-3" id="text-19-1">
          <p>y = β<sub>0</sub> + β<sub>1</sub> x + ε</p>

          <div class="org-src-container">
            <pre class="src src-R">
x <span class=
"org-constant">&lt;-</span> rnorm(100)                         <span class=
"org-comment-delimiter"># </span><span class="org-comment">predictor</span>
e <span class=
"org-constant">&lt;-</span> rnorm(100, 0, 2)                   <span class=
"org-comment-delimiter"># </span><span class="org-comment">noise</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-19-2" class="outline-3">
        <h3 id="sec-19-2"><span class="section-number-3">19.2</span> Regression
        tree models</h3>

        <div class="outline-text-3" id="text-19-2">
          <ul class="org-ul">
            <li>arbres de régression : la variable expliquée est de type
            numérique et il s’agit de prédire une valeur la plus proche
            possible de la vraie valeur.</li>
          </ul>

          <p><a href=
          "http://www.statmethods.net/advstats/cart.html">http://www.statmethods.net/advstats/cart.html</a></p>
        </div>
      </div>

      <div id="outline-container-sec-19-3" class="outline-3">
        <h3 id="sec-19-3"><span class="section-number-3">19.3</span>
        Classification tree models</h3>

        <div class="outline-text-3" id="text-19-3">
          <ul class="org-ul">
            <li>arbres de classification : la variable expliquée est de type
            nominale (facteur). A chaque étape du partitionnement, on cherche à
            réduire l’impureté totale des deux noeuds fils par rapport au noeud
            père.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-R">
rpart
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-20" class="outline-2">
      <h2 id="sec-20"><span class="section-number-2">20</span> Debugging</h2>

      <div class="outline-text-2" id="text-20">
        <ul class="org-ul">
          <li>3 main indications of a problem / <code>condition</code>:

            <ul class="org-ul">
              <li>
                <p><code>message</code></p>

                <div class="org-src-container">
                  <pre class="src src-R">
print(<span class="org-string">"message"</span>)
</pre>
                </div>
              </li>

              <li>
                <p><code>warning</code></p>

                <div class="org-src-container">
                  <pre class="src src-R">
log(-1)
</pre>
                </div>
              </li>

              <li>
                <p><code>error</code></p>

                <div class="org-src-container">
                  <pre class="src src-R">
<span class="org-keyword">stop</span>(<span class=
"org-string">"error"</span>)                       <span class=
"org-comment-delimiter"># </span><span class=
"org-comment">throw an error</span>
</pre>
                </div>
              </li>
            </ul>
          </li>

          <li>General notion of a <code>condition</code>: you can create your
          own if something specific happens</li>

          <li>Functions:

            <dl class="org-dl">
              <dt>invisible(x)</dt>

              <dd><b>Prevent auto-printing</b> of the last element in the
              function value; <b>still return</b> the same object</dd>
            </dl>
          </li>

          <li>
            <b>Interactive</b> debugging tools to find problematic code:

            <dl class="org-dl">
              <dt><code>traceback</code></dt>

              <dd>Print out the function call stack – you have to call it
              <b>immediately</b> after the error occurred.</dd>

              <dt><code>debug</code></dt>

              <dd>Flag a function for “debug” mode to step through any function
              (you wrote or not), one expression at a time, from the top of the
              function.</dd>

              <dt>browser</dt>

              <dd>Put the function in debug mode anywhere in your code; in the
              browser, there is nothing in your environment except for the
              function arguments (and the default values which are not listed).
              You can nest browser frames: you can call the debug function even
              while you’re in the debugger.</dd>

              <dt>trace</dt>

              <dd>Insert debugging code into a function, without actually
              editing the function.</dd>

              <dt>recover</dt>

              <dd>
                <p>Modify the default behavior (of getting the console back) by
                creating an error handler.</p>

                <div class="org-src-container">
                  <pre class="src src-R">
options(error = recover)
</pre>
                </div>
              </dd>
            </dl>
          </li>

          <li>Blunt techniques:

            <ul class="org-ul">
              <li><code>print</code></li>

              <li><code>cat</code></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>

    <div id="outline-container-sec-21" class="outline-2">
      <h2 id="sec-21"><span class="section-number-2">21</span> Assert</h2>

      <div class="outline-text-2" id="text-21">
        <div class="org-src-container">
          <pre class="src src-R">
<span class="org-comment-delimiter">## </span><span class=
"org-comment">TODO Add a message to use; if not provided, generic one...</span>
<span class="org-function-name">warn_if_not_empty</span> <span class=
"org-constant">&lt;-</span> <span class=
"org-keyword">function</span> (..., env = parent.frame())
{
  check <span class="org-constant">&lt;-</span> eval(substitute(alist(...)))
  cat(paste(check, <span class="org-string">"empty?\n"</span>))

  expr <span class="org-constant">&lt;-</span> eval(parse(text=check))

  <span class="org-keyword">if</span> (nrow(expr) == 0) {
    cat(<span class="org-string">"OK!\n"</span>)
    <span class="org-keyword">return</span>(<span class="org-type">TRUE</span>)
  } <span class="org-keyword">else</span> {
    print(expr)
    <span class="org-keyword">stop</span>(nrow(expr), <span class=
"org-string">"contradictions.\n"</span>)
  }
}

<span class="org-comment-delimiter">## </span><span class=
"org-comment">warn_if_not_empty(pfisortie[is.na(pfisortie$frmArretDate), ])</span>
<span class="org-comment-delimiter">##</span>
<span class="org-comment-delimiter">## </span><span class=
"org-comment">warn_if_not_empty(pfisortie[is.na(pfisortie$stgNom.x), ])</span>
</pre>
        </div>
      </div>
    </div>
  </div>

  <div id="postamble" class="status">
    <div id="footer">
      <div id="copyright">
        Copyright © Fabrice Niessen
      </div>
    </div>
  </div>
</body>
</html>
